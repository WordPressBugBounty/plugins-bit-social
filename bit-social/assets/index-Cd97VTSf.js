import{q as le,v as de,w as ue,A as he,a0 as j,r as R,G as pe,X as me,Y as ge,ao as F,z as i,j as s,T as I,y as l,B as S,L as Se,ah as fe,S as M,af as z,Q as Te,F as P,J as xe,a1 as B,ap as ye,ai as _,K as _e}from"./main-long-peas-go.js";import{u as be,t as Ce,$ as Ae,a as ve,b as Ie}from"./DatePicker-CdxJP29K.js";import{u as Me}from"./useDebounce-mLcXwJwA.js";import{C as Pe}from"./CronWarning-MeO-m6Nt.js";import{u as ke,N as Ee}from"./useUpdateScheduleStatus-CiL-Yi60.js";import{u as we,C as O}from"./CreateScheduleModal-5KFJFu83.js";import{D as De,R as Le,F as Ne}from"./Refresh-ClMhDmrQ.js";import{d as b}from"./index-D98yetV8.js";import{s as $e}from"./index-CAJo5LBM.js";import{T as U}from"./index-DdPW9VtV.js";import{S as je,I as Re,E as Fe}from"./index-DaoY7BSh.js";import{P as Y}from"./index-90n6XQW4.js";import{F as ze}from"./index-Be20YS-J.js";import"./useSocialTemplates-DP_0FLgW.js";import"./PlatformIcon-Bomv0TDT.js";import"./index-DJhBAvNb.js";import"./row-B5t-vFhF.js";import"./index-CFra5WNQ.js";import"./useIntervalTypes-CFPg7g4N.js";import"./groupHelper-IC5Ui1eE.js";import"./index-wofh9BiW.js";import"./EllipsisOutlined-C3HrFNNq.js";import"./Dropdown-B3y2dOt4.js";import"./index-CH6NCk7x.js";import"./index-DnDsy9RE.js";import"./index-BMT943CC.js";import"./collapse-BbEVqHco.js";import"./index-D6m8yw2l.js";import"./index-ccB_VSNz.js";import"./index-BtYGUORV.js";import"./EyeOutlined-w0DyFVDf.js";import"./addEventListener-C-7Y-bqR.js";import"./LeftOutlined-DhYmm84w.js";import"./AntIconWrapper-B4zKS0bQ.js";import"./emotion-react.browser.esm-DMGDLIEi.js";import"./usePostTypes-CkBV3M9z.js";import"./index-wkHUffAe.js";import"./context-DNsUQVd6.js";import"./index-BmiJEYUo.js";import"./index-DRO8vIvJ.js";import"./move-SdPZUYuE.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};function Be(){const a=le(),{isPending:n,isSuccess:p,mutateAsync:f}=de({mutationFn:async d=>{if(!d.length)throw new Error("Schedule ID is undefined");return ue("schedule/destroy",{scheduleIds:d},void 0,"POST")},onSuccess:()=>{a.invalidateQueries({queryKey:["get-calendar-schedules"]}),a.invalidateQueries({queryKey:["all-schedules"]})}});return{deleteSchedule:d=>f(d),deleteScheduleLoading:n,deleteScheduleSuccess:p}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};b.extend(be);b.extend(Ce);const Oe=({token:a})=>({background:a.colorSuccessBg,border:`1px solid ${a.colorSuccessBorder}`,borderRadius:"10px",color:a.colorSuccessText,minWidth:"90px"}),Ue=({token:a})=>({background:a.colorWarningBg,border:`1px solid ${a.colorWarningBorder}`,borderRadius:"10px",color:a.colorWarningText,minWidth:"90px"}),h=1,k=0,E=2,Ye=4;function wt(){const[a,n]=he(),p=Number(a.get("page"))||1,f=Number(a.get("limit"))||10,[d,T]=j(Ae),[C,m]=R.useState([]),w=pe(ve),[D,H]=j(Ie),u=Me(D,300),{isFetchingSchedules:L,isLoadingSchedules:A,refetchSchedules:x,scheduleData:r,totalPages:v,totalSchedule:W}=we(u,p,f),{deleteSchedule:N,deleteScheduleLoading:q}=Be(),{updateScheduleStatus:Q}=ke(),[K,V]=$e.useNotification(),{timeZone:$}=me(ge),G=b(F($)).format("YYYY-MM-DD HH:mm:ss"),J=(e,o="success")=>{K[o]({description:e,message:"Share Now"})},X=(e,o)=>{n(t=>(t.set("page",String(e)),t.set("limit",String(o)),t))},Z=e=>{const o=r.find(t=>t.id===e);o&&(w(B(o.config,t=>{t.id=o.id})),T({open:!0,type:"edit"}))},ee=e=>{const o=r.find(t=>t.id===e);o&&(w(B(o.config,t=>{t.settings.name=`Reschedule: ${t.settings.name}`,t.settings.started_at=G,delete t.id})),T({open:!0,type:"reSchedule"}))},te=e=>{H(e.target.value)},ae=async()=>{await N(C),m([]),x()},se=async e=>{await N([e]),x()},oe=async(e,o)=>{const{data:t,status:c}=await Q({id:e,status:o});J(t,c),x()},ie=[{dataIndex:"title",key:"title",title:i("Title"),width:"20%"},{dataIndex:"created_at",key:"created_at",title:i("Created At")},{dataIndex:"start",key:"start",title:i("Start Scheduled Post")},{dataIndex:"interval",key:"interval",render:(e,{interval:o})=>{var t;return(t=o.settings)!=null&&t.post_interval_value?s(I.Text,{children:`${o.settings.post_interval_value}  ${o.settings.post_interval_type}`}):"-"},title:i("Interval ")},{dataIndex:"nextPost",key:"nextPost",title:i("Next Post ")},{dataIndex:"status",key:"status",render:(e,{interval:o,key:t,status:c})=>{var g;if(!((g=o.settings)!=null&&g.post_interval_value)&&c===h)return s(U,{color:"green",children:i("In Progress")});switch(c){case E:return s(U,{color:"grey",children:i("Completed")});case h:case k:return s(je,{css:c===h?Oe:Ue,onChange:y=>oe(t,Number(y)),options:[{disabled:c===h,label:i("Active"),value:h},{disabled:c===k,label:i("Paused"),value:k}],size:"small",value:c===h?"Active":"Paused",variant:"borderless"})}},title:i("Status")},{dataIndex:"action",key:"action",render:(e,{interval:o,key:t,status:c})=>{var g,y;return l(M,{direction:"horizontal",children:[s(Y,{description:i("Are you sure you want to delete this schedule?"),okButtonProps:{danger:!0,loading:q},okText:i("Yes, Delete"),onConfirm:()=>se(t),placement:"right",title:i("Delete?"),children:s(S,{danger:!0,icon:s(Se,{}),type:"text"})}),((g=o.settings)==null?void 0:g.post_interval_value)&&c!==E&&s(S,{icon:s(ye,{}),onClick:()=>Z(t),type:"text"}),((y=o.settings)==null?void 0:y.post_interval_value)&&(c===E||c===Ye)&&s(S,{icon:s(fe,{}),onClick:()=>ee(t),title:i("Re-schedule"),type:"text"})]})},title:i("Action ")}],re=r&&r.map(e=>({created_at:z(e.created_at,`${_.DATE_FORMAT} ${_.TIME_FORMAT}`),interval:e.config,key:e.id,nextPost:e.next_published_at&&e.status===1&&b(e.next_published_at).diff(F($))>1?e.human_readable_next_publish:"-",start:e!=null&&e.started_at?z(e.started_at,`${_.DATE_FORMAT} ${_.TIME_FORMAT}`):"-",status:e.status,title:e.name})),ne={onSelect:(e,o)=>{if(e){if(o){m(t=>[...t,e.key]);return}m(t=>t.filter(c=>c!==e.key))}},onSelectAll:(e,o)=>{if(e){m(o.map(t=>t==null?void 0:t.key).filter(t=>t!==void 0));return}m([])}},ce=C.length>0;return R.useEffect(()=>{!r.length&&v&&p>v&&n(e=>(e.set("page",String(v)),e))},[r]),l(P,{children:[V,l(ze,{className:"mb-1",justify:"space-between",children:[l(M,{children:[!u&&r.length||u?s(Re,{onChange:te,placeholder:i("Search schedule"),prefix:s(Te,{}),value:D}):void 0,ce?l(P,{children:[s(I.Text,{children:`Selected ${C.length} items`}),s(Y,{description:i("Are you sure to delete this logs?"),okButtonProps:{danger:!0},okText:i("Yes, Delete"),onConfirm:ae,placement:"right",title:i("Delete Logs"),children:s(S,{className:"ml-2",danger:!0,icon:s(De,{}),type:"text"})})]}):void 0]}),s("div",{children:!u&&r.length||u?l(M,{children:[l(I.Link,{href:"https://bit-social.com/docs/schedule-wordpress-posts-on-social-media/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[i("How to create schedule"),s(xe,{style:{transform:"translateY(-2px)"}})]}),s(S,{disabled:L,icon:s(Le,{spin:L}),onClick:()=>x(),size:"large",children:i("Refresh")}),s(O,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:T})]}):void 0})]}),A&&s(_e,{}),r!=null&&r.length?l(P,{children:[s(Pe,{}),s(Ne,{bordered:!0,className:"mt-1",columns:ie,dataSource:re,pagination:{current:p,defaultCurrent:1,onChange:X,pageSize:f,showSizeChanger:!0,total:W},rowSelection:ne})]}):void 0,!A&&!(r!=null&&r.length)?s(Fe,{description:i("No schedule found!"),children:!u&&s(O,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:T})}):void 0,!A&&!(r!=null&&r.length)?s(Ee,{fontSize:"1.6rem",section:"schedule",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};export{wt as default};
