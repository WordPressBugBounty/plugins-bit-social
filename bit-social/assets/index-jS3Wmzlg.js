import{x as le,y as de,z as ue,G as he,a4 as $,r as R,I as pe,a2 as me,a3 as ge,as as F,D as i,j as s,T as I,B as l,E as S,S as M,aj as z,F as P,N as Se,L as fe,at as Te,am as xe,an as _,V as ye,O as _e,a5 as O}from"./main-silver-symbols-shake.js";import{$ as be,a as Ce,b as Ae,u as ve,t as Ie}from"./DatePicker-Dw1BIez7.js";import{u as Me}from"./useDebounce-DeMZeVHL.js";import{C as Pe}from"./CronWarning-Cl7ufTZg.js";import{u as Ee,N as ke}from"./useUpdateScheduleStatus-B4d-dsDq.js";import{u as De,C as B}from"./CreateScheduleModal-Aqrdjc01.js";import{R as we,D as Le,F as Ne}from"./Refresh-E2NdJLCB.js";import{d as b}from"./index-Cnc7Kb5Q.js";import{s as je}from"./index-0LT9N2G4.js";import{T as U}from"./index-BUzg1ML9.js";import{S as $e,E as Re}from"./Input-CLHqygxh.js";import{P as Y}from"./index-CPg7DcoS.js";import{F as Fe}from"./index-1dpm7-QQ.js";import{I as ze}from"./index-CFB4fwW5.js";import"./useSocialTemplates-Bd3Vgw73.js";import"./PlatformIcon-ChyZlnD4.js";import"./index-BURASk8o.js";import"./row-ND2YRcMq.js";import"./EllipsisOutlined-Cr_UQ4tg.js";import"./index-BeUQZpGU.js";import"./useIntervalTypes-DPi9JuSO.js";import"./groupHelper-BL5H9ta2.js";import"./index-bfsX3pxN.js";import"./Dropdown-C-VOEsfQ.js";import"./index-CfXpWy5j.js";import"./index-CJKOBAd8.js";import"./index-CVpTIA97.js";import"./collapse-BbEVqHco.js";import"./index-DjcDhUNV.js";import"./index-Bv7R9vsE.js";import"./index-0UKlqzim.js";import"./EyeOutlined-0QJ6t1Ml.js";import"./addEventListener-C6_Yv7RP.js";import"./LeftOutlined-CAvVX6_B.js";import"./AntIconWrapper-DwVLu9qI.js";import"./emotion-react.browser.esm-C0RHj4UF.js";import"./usePostTypes-r0Z8vIhd.js";import"./index-DoBCqMXC.js";import"./context-i3j7j-cS.js";import"./index-LQ3KT2M4.js";import"./index-BbUeebXm.js";import"./move-Dn9EjVcS.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};function Oe(){const a=le(),{isPending:n,isSuccess:p,mutateAsync:f}=de({mutationFn:async d=>{if(!d.length)throw new Error("Schedule ID is undefined");return ue("schedule/destroy",{scheduleIds:d},void 0,"POST")},onSuccess:()=>{a.invalidateQueries({queryKey:["get-calendar-schedules"]}),a.invalidateQueries({queryKey:["all-schedules"]})}});return{deleteSchedule:d=>f(d),deleteScheduleLoading:n,deleteScheduleSuccess:p}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};b.extend(ve);b.extend(Ie);const Be=({token:a})=>({background:a.colorSuccessBg,border:`1px solid ${a.colorSuccessBorder}`,borderRadius:"10px",color:a.colorSuccessText,minWidth:"90px"}),Ue=({token:a})=>({background:a.colorWarningBg,border:`1px solid ${a.colorWarningBorder}`,borderRadius:"10px",color:a.colorWarningText,minWidth:"90px"}),h=1,E=0,k=2,Ye=4;function wt(){const[a,n]=he(),p=Number(a.get("page"))||1,f=Number(a.get("limit"))||10,[d,T]=$(be),[C,m]=R.useState([]),D=pe(Ce),[w,H]=$(Ae),u=Me(w,300),{isFetchingSchedules:L,isLoadingSchedules:A,refetchSchedules:x,scheduleData:r,totalPages:v,totalSchedule:W}=De(u,p,f),{deleteSchedule:N,deleteScheduleLoading:q}=Oe(),{updateScheduleStatus:Q}=Ee(),[V,K]=je.useNotification(),{timeZone:j}=me(ge),G=b(F(j)).format("YYYY-MM-DD HH:mm:ss"),Z=(e,o="success")=>{V[o]({description:e,message:"Share Now"})},J=(e,o)=>{n(t=>(t.set("page",String(e)),t.set("limit",String(o)),t))},X=e=>{const o=r.find(t=>t.id===e);o&&(D(O(o.config,t=>{t.id=o.id})),T({open:!0,type:"edit"}))},ee=e=>{const o=r.find(t=>t.id===e);o&&(D(O(o.config,t=>{t.settings.name=`Reschedule: ${t.settings.name}`,t.settings.started_at=G,delete t.id})),T({open:!0,type:"reSchedule"}))},te=e=>{H(e.target.value)},ae=async()=>{await N(C),m([]),x()},se=async e=>{await N([e]),x()},oe=async(e,o)=>{const{data:t,status:c}=await Q({id:e,status:o});Z(t,c),x()},ie=[{dataIndex:"title",key:"title",title:i("Title"),width:"20%"},{dataIndex:"created_at",key:"created_at",title:i("Created At")},{dataIndex:"start",key:"start",title:i("Start Scheduled Post")},{dataIndex:"interval",key:"interval",render:(e,{interval:o})=>{var t;return(t=o.settings)!=null&&t.post_interval_value?s(I.Text,{children:`${o.settings.post_interval_value}  ${o.settings.post_interval_type}`}):"-"},title:i("Interval ")},{dataIndex:"nextPost",key:"nextPost",title:i("Next Post ")},{dataIndex:"status",key:"status",render:(e,{interval:o,key:t,status:c})=>{var g;if(!((g=o.settings)!=null&&g.post_interval_value)&&c===h)return s(U,{color:"green",children:i("In Progress")});switch(c){case k:return s(U,{color:"grey",children:i("Completed")});case h:case E:return s($e,{css:c===h?Be:Ue,onChange:y=>oe(t,Number(y)),options:[{disabled:c===h,label:i("Active"),value:h},{disabled:c===E,label:i("Paused"),value:E}],size:"small",value:c===h?"Active":"Paused",variant:"borderless"})}},title:i("Status")},{dataIndex:"action",key:"action",render:(e,{interval:o,key:t,status:c})=>{var g,y;return l(M,{direction:"horizontal",children:[s(Y,{description:i("Are you sure you want to delete this schedule?"),okButtonProps:{danger:!0,loading:q},okText:i("Yes, Delete"),onConfirm:()=>se(t),placement:"right",title:i("Delete?"),children:s(S,{danger:!0,icon:s(fe,{}),type:"text"})}),((g=o.settings)==null?void 0:g.post_interval_value)&&c!==k&&s(S,{icon:s(Te,{}),onClick:()=>X(t),type:"text"}),((y=o.settings)==null?void 0:y.post_interval_value)&&(c===k||c===Ye)&&s(S,{icon:s(xe,{}),onClick:()=>ee(t),title:i("Re-schedule"),type:"text"})]})},title:i("Action ")}],re=r&&r.map(e=>({created_at:z(e.created_at,`${_.DATE_FORMAT} ${_.TIME_FORMAT}`),interval:e.config,key:e.id,nextPost:e.next_published_at&&e.status===1&&b(e.next_published_at).diff(F(j))>1?e.human_readable_next_publish:"-",start:e!=null&&e.started_at?z(e.started_at,`${_.DATE_FORMAT} ${_.TIME_FORMAT}`):"-",status:e.status,title:e.name})),ne={onSelect:(e,o)=>{if(e){if(o){m(t=>[...t,e.key]);return}m(t=>t.filter(c=>c!==e.key))}},onSelectAll:(e,o)=>{if(e){m(o.map(t=>t==null?void 0:t.key).filter(t=>t!==void 0));return}m([])}},ce=C.length>0;return R.useEffect(()=>{!r.length&&v&&p>v&&n(e=>(e.set("page",String(v)),e))},[r]),l(P,{children:[K,l(Fe,{className:"mb-1",justify:"space-between",children:[l(M,{children:[!u&&r.length||u?s(ze,{onChange:te,placeholder:i("Search schedule"),prefix:s(ye,{}),value:w}):void 0,ce?l(P,{children:[s(I.Text,{children:`Selected ${C.length} items`}),s(Y,{description:i("Are you sure to delete this logs?"),okButtonProps:{danger:!0},okText:i("Yes, Delete"),onConfirm:ae,placement:"right",title:i("Delete Logs"),children:s(S,{className:"ml-2",danger:!0,icon:s(Le,{}),type:"text"})})]}):void 0]}),s("div",{children:!u&&r.length||u?l(M,{children:[l(I.Link,{href:"https://bit-social.com/docs/schedule-wordpress-posts-on-social-media/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[i("How to create schedule"),s(Se,{style:{transform:"translateY(-2px)"}})]}),s(S,{disabled:L,icon:s(we,{spin:L}),onClick:()=>x(),size:"large",children:i("Refresh")}),s(B,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:T})]}):void 0})]}),A&&s(_e,{}),r!=null&&r.length?l(P,{children:[s(Pe,{}),s(Ne,{bordered:!0,className:"mt-1",columns:ie,dataSource:re,pagination:{current:p,defaultCurrent:1,onChange:J,pageSize:f,showSizeChanger:!0,total:W},rowSelection:ne})]}):void 0,!A&&!(r!=null&&r.length)?s(Re,{description:i("No schedule found!"),children:!u&&s(B,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:T})}):void 0,!A&&!(r!=null&&r.length)?s(ke,{fontSize:"1.6rem",section:"schedule",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};export{wt as default};
