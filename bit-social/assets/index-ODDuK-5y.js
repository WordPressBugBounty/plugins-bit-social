import{f as qe,r as oe,g as Le,e as De,c as Ke,l as we,m as se,n as X,a as p,j as a,F as $,_ as x,L as W,h as ee,u as me,b as fe,p as L,o as Ge,q as Je}from"./main-some-women-speak.js";import{r as B,s as be,z as H,k as Me,S as R,T as q,P as Te,B as P,j as ne,x as Ze,E as Xe,n as et,q as ue,v as ge,J as ke,K as te,o as M,I as K,U as Fe,i as Ee,h as tt,m as at,G as st,M as Ue,w as it,F as Ae,H as nt,N as ot}from"./antd-Dkhz2BjJ.js";import{C as He}from"./CronWarning-BDlyjNsw.js";import{u as ct,N as rt}from"./useUpdateScheduleStatus-C6HBCA31.js";import{D as lt,R as ht}from"./Refresh-vI4MAna2.js";import{u as Re}from"./router-BDBqwsZt.js";import{a as Be,b as Ce,u as dt,k as ut,Q as pt}from"./react-query-B4O-PG_a.js";import{P as gt}from"./PlatformIcon-DUhbVgxv.js";import{u as mt,a as ft,g as bt,C as ve}from"./groupHelper-LXyWAMdx.js";import{u as Ct,F as yt,A as St}from"./useIntervalTypes-Dy4Aw593.js";import{b as wt,D as Tt,g as kt}from"./DatePicker-CqphXXkq.js";import{p as At}from"./TemplateDocLink-BhGFtmRP.js";import"./ProGoogleBusinessProfileSettings-BqvOidJL.js";import"./css-in-js-D9KZUreV.js";import"./_socialTemplates-Dn3A61Ix.js";import"./index-CAwduSRX.js";import"./useMemoDebounce-C2yfnHyS.js";import"./useUpdateSocialTemplates-CWZQ699N.js";import"./PreviewDummy-BHV2gQSH.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const $e=()=>({accounts:{accountIds:[],groupIds:[]},platforms:[],settings:{name:"",post_interval_type:"hour",post_interval_value:1,repeat:!1,started_at:void 0},templates:{all:{content:"",isLinkCard:!1,link:"",media:[]},discord:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},facebook:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},googleBusinessProfile:{button:"none",content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},instagram:{comment:"",content:"",edit:!1,isAllImages:!0,media:[]},linkedin:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},pinterest:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},tumblr:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},twitter:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]}}}),G=globalThis.jotaiAtomCache.get("/home/runner/work/bit-social/bit-social/frontend/src/common/globalStates/$shareNowData.ts/$shareNowData",qe($e()));G.debugLabel="$shareNowData";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function vt(e,t){const l=Be(),{isPending:s,mutateAsync:T}=Ce({mutationFn:async I=>oe("share-now/destroy/batch",{shareNowIds:I},void 0,"POST"),onSuccess:()=>{l.invalidateQueries({queryKey:["share-now",[t,e]]})}});return{deleteShareNow:I=>T(I),isShareNowDeleting:s}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Oe(e,t){const{data:l,isFetching:s,isLoading:T,refetch:I}=dt({enabled:!!t&&!!e,placeholderData:ut,queryFn:async()=>oe(`share-now/${e}/${t}`,void 0,void 0,"GET"),queryKey:["share-now",[e,t]],refetchInterval:5e3}),{current_page:d,current_total:C,data:_,pages:k,per_page:o,total:N}=(l==null?void 0:l.data)||{};return{currentPage:d,currentTotal:C,isFetchingShareNowList:s,isLoadingShareNowList:T,perPage:o,refetchShareNowList:I,shareNowData:_||[],totalPages:k,totalShareNow:N}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const xt=({token:e})=>({background:e.colorSuccessBg,border:`1px solid ${e.colorSuccessBorder}`,borderRadius:"10px",color:e.colorSuccessText,minWidth:"90px"}),_t=({token:e})=>({background:e.colorWarningBg,border:`1px solid ${e.colorWarningBorder}`,borderRadius:"10px",color:e.colorWarningText,minWidth:"90px"}),pe=0,J=1,xe=2,Nt=3,It=4;function jt({setShareNowModal:e}){const[t,l]=Re({}),s=Number(t.get("page"))||1,T=Number(t.get("limit"))||10,{timeZone:I}=Le(De),{isFetchingShareNowList:d,isLoadingShareNowList:C,refetchShareNowList:_,shareNowData:k,totalPages:o,totalShareNow:N}=Oe(s,T),[c,n]=B.useState([]),{updateScheduleStatus:m}=ct(),{deleteShareNow:h,isShareNowDeleting:y}=vt(T,s),j=Ke(G),[F,Q]=be.useNotification(),f=(i,b="success")=>{F[b]({description:i,message:"Share Now"})},r=k.map(i=>({created_at:we(i.created_at,`${se.DATE_FORMAT} ${se.TIME_FORMAT}`),interval:i.config,key:i.id,nextPost:i.next_published_at&&i.status===1&&H(i.next_published_at).diff(X(I))>1?i.human_readable_next_publish:"-",start:i!=null&&i.config.settings.started_at?we(i==null?void 0:i.config.settings.started_at,`${se.DATE_FORMAT} ${se.TIME_FORMAT}`):"-",status:i.status,title:i.name})),A=async(i,b)=>{const{data:u,status:V}=await m({id:i,status:b});f(u,V),_()},D=()=>{j($e()),e({open:!0,type:"create"})},O=async i=>{await h([i]),_()},Y=i=>{const b=k.find(u=>u.id===i);b&&(j(u=>({...u,accounts:b.config.accounts,id:i,settings:b.config.settings,status:b.status,templates:b.config.templates})),e({open:!0,type:"edit"}))},E=[{dataIndex:"title",key:"title",title:"Title",width:"20%"},{dataIndex:"created_at",key:"created_at",title:"Created At"},{dataIndex:"start",key:"start",title:"Start Scheduled Post"},{dataIndex:"interval",key:"interval",render:(i,{interval:b})=>a(q.Text,{children:b.settings.repeat?`${b.settings.post_interval_value} ${b.settings.post_interval_type}`:"-"}),title:"Interval "},{dataIndex:"nextPost",key:"nextPost",title:"Next Post "},{dataIndex:"status",key:"status",render:(i,{key:b,status:u})=>{switch(u){case J:case pe:return a(ge,{css:u===J?xt:_t,onChange:V=>A(b,Number(V)),options:[{disabled:u===J,label:"Active",value:J},{disabled:u===pe,label:"Paused",value:pe}],size:"small",value:u===J?"Active":"Paused",variant:"borderless"});case xe:return a(ue,{color:"grey",children:x("Completed")});case Nt:return a(ue,{color:"purple",children:x("Draft")});case It:return a(ue,{color:"red",children:x("Missed")})}},title:"Status"},{dataIndex:"action",key:"action",render:(i,{key:b,status:u})=>p(R,{direction:"horizontal",children:[u!==xe&&a(P,{icon:a(W,{name:"pencil"}),onClick:()=>Y(b),type:"text"}),a(Te,{description:"Are you sure you want to delete this schedule?",okButtonProps:{danger:!0,loading:y},okText:"Yes, Delete",onConfirm:()=>O(b),placement:"right",title:"Delete?",children:a(P,{danger:!0,icon:a(W,{name:"trash-2"}),type:"text"})})]}),title:"Action "}],ce=(i,b)=>{l(u=>(u.set("page",String(i)),u.set("limit",String(b)),u))},re={onSelect:(i,b)=>{if(i){if(b){n(u=>[...u,i.key]);return}n(u=>u.filter(V=>V!==i.key))}},onSelectAll:(i,b)=>{if(i){n(b.map(u=>u==null?void 0:u.key).filter(u=>u!==void 0));return}n([])}},ae=c.length>0,le=async()=>{await h(c),n([]),_()};return B.useEffect(()=>{!k.length&&o&&s>o&&l(i=>(i.set("page",String(o)),i))},[k]),p($,{children:[Q,p(Me,{className:"mb-2",justify:"space-between",children:[a(ne,{children:a(R,{children:ae?p($,{children:[a(q.Text,{children:`Selected ${c.length} items`}),a(Te,{description:"Are you sure to delete this logs?",okText:"Confirm",onConfirm:le,placement:"right",title:"Delete Logs",children:a(P,{danger:!0,icon:a(lt,{}),type:"text"})})]}):void 0})}),a(ne,{children:r!=null&&r.length?p(R,{children:[p(q.Link,{href:"https://bit-social.com/docs/instantly-share-posts-on-social-media-platforms/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[x("How to share a post instantly"),a(W,{name:"move-up-right",style:{transform:"translateY(-2px)"}})]}),a(P,{disabled:C||d,icon:a(ht,{spin:C||d}),onClick:()=>_(),size:"large",children:x("Refresh")}),a(P,{icon:a(W,{name:"plus"}),onClick:D,size:"large",type:"primary",children:x("Share Post")})]}):void 0})]}),r!=null&&r.length?p($,{children:[a(He,{}),a(Ze,{bordered:!0,className:"mt-1",columns:E,dataSource:r,pagination:{current:s,defaultCurrent:1,onChange:ce,pageSize:T,showSizeChanger:!0,total:N},rowSelection:re})]}):void 0,!C&&!(r!=null&&r.length)?a(Xe,{description:"No Share Post found!",children:a(P,{icon:a(W,{name:"plus"}),onClick:D,size:"large",type:"primary",children:x("Share Post")})}):void 0,C&&a(et,{}),!C&&!(r!=null&&r.length)?a(rt,{fontSize:"1.6rem",section:"shareNow",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}const Pt=""+new URL("bit-social-ba-assets-543.svg",import.meta.url).href;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Lt(){const e=new pt,{isPending:t,isSuccess:l,mutateAsync:s}=Ce({mutationFn:async T=>oe("share-now",{...T},void 0,"POST"),onSuccess:()=>{e.invalidateQueries({queryKey:["all-schedules"]}),e.invalidateQueries({queryKey:["get-calendar-schedules"]}),e.invalidateQueries({queryKey:["share-now"]})}});return{createShareNow:s,isCreateShareNowLoading:t,isShareNowSuccess:l}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Dt(){const e=Be(),{isPending:t,mutateAsync:l}=Ce({mutationFn:async s=>oe(`share-now/${s.id}/update`,{...s},void 0,"POST"),onSuccess:()=>{e.invalidateQueries({queryKey:["share-now",[1,10]]})}});return{isUpdateShareNowLoading:t,updateShareNow:l}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const _e=e=>{for(const t in e)if(e.hasOwnProperty(t)){const l=e[t];if(l.text||l.media.length)return!0}return!1};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ze=e=>({name:e.filename,uid:e.id,url:e.url});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function We({handleCheckBox:e,templateData:t,type:l}){return p($,{children:[l.includes("isLinkCard")&&a(te,{title:"Enable to the link shared as a card",children:a(ke,{checked:t.isLinkCard,onChange:s=>{e("isLinkCard",s.target.checked)},children:x("Link")})}),l.includes("isAllImages")&&a(te,{title:"Enable to selected image shared",children:a(ke,{checked:t.isAllImages,onChange:s=>{e("isAllImages",s.target.checked)},children:x("Media")})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Mt=3e3;function Ft(){var k,o,N;const[e,t]=ee(G),{isProClient:l}=me(fe),s=["isLinkCard","isAllImages"],T=c=>{t(n=>L(n,m=>{m.templates.facebook.content=c.target.value}))},I=(c,n)=>{t(m=>L(m,h=>{h.templates.facebook.isLinkCard=!1,h.templates.facebook.isAllImages=!1,h.templates.facebook[c]=n}))},d=c=>{const{value:n}=c.target;t(m=>L(m,h=>{h.templates.facebook.link=n}))},C=({fileList:c})=>{const n=L(e,m=>{m.templates.facebook.media=c});t(n)},_=()=>{const c=["image/jpg","image/jpeg","image/png","image/webp"];if(typeof wp<"u"&&wp.media){const n=wp.media({button:{text:"Select Image"},library:{type:c},multiple:l?"add":!1,title:"Media"}),m=e.templates.facebook.media.map(h=>h.uid);n.on("open",()=>{const h=n.state().get("selection");m.forEach(y=>{const j=wp.media.attachment(y);j.fetch().done(()=>{h.add(j)})})}),n.on("select",()=>{const h=n.state().get("selection").toJSON();let y=[];y=h.map(F=>ze(F));const j=y.at(-1)||{};C({file:j,fileList:y})}),n.open()}};return a(Ee,{children:p(M,{layout:"vertical",children:[a(M.Item,{htmlFor:"textBox",label:"Post",children:a(K.TextArea,{id:"textBox",maxLength:Mt,onChange:c=>T(c),placeholder:"Write your custom post",showCount:!0,style:{height:120,resize:"none"},value:e.templates.facebook.content})}),a(R,{className:"py-2",children:a(We,{handleCheckBox:I,templateData:e.templates.facebook,type:s})}),((k=e.templates.facebook)==null?void 0:k.isLinkCard)&&a(M.Item,{htmlFor:"link",label:"Link",children:a(K,{id:"link",onChange:c=>d(c),placeholder:"https://example.com",value:e.templates.facebook.link})}),!((o=e.templates.facebook)!=null&&o.isLinkCard)&&((N=e.templates.facebook)==null?void 0:N.isAllImages)&&a(Fe,{fileList:e.templates.facebook.media,listType:"picture-card",onChange:C,openFileDialogOnClick:!1,children:a(te,{placement:"right",title:"Add Image",children:a(P,{onClick:_,style:{height:"100%",width:"100%"},children:p(R,{direction:"vertical",children:[a(W,{name:"upload",size:20}),x("Upload")]})})})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Et=3e3;function Ut(){var k,o,N;const[e,t]=ee(G),{isProClient:l}=me(fe),s=["isLinkCard","isAllImages"],T=c=>{t(n=>L(n,m=>{m.templates.linkedin.content=c.target.value}))},I=(c,n)=>{t(m=>L(m,h=>{h.templates.linkedin.isLinkCard=!1,h.templates.linkedin.isAllImages=!1,h.templates.linkedin[c]=n}))},d=c=>{const{value:n}=c.target;t(m=>L(m,h=>{h.templates.linkedin.link=n}))},C=({fileList:c})=>{const n=L(e,m=>{m.templates.linkedin.media=c});t(n)},_=()=>{const c=["image/jpg","image/jpeg","image/png","image/webp"];if(typeof wp<"u"&&wp.media){const n=wp.media({button:{text:"Select Image"},library:{type:c},multiple:l?"add":!1,title:"Media"}),m=e.templates.linkedin.media.map(h=>h.uid);n.on("open",()=>{const h=n.state().get("selection");m.forEach(y=>{const j=wp.media.attachment(y);j.fetch().done(()=>{h.add(j)})})}),n.on("select",()=>{const h=n.state().get("selection").toJSON();let y=[];y=h.map(F=>ze(F));const j=y.at(-1)||{};C({file:j,fileList:y})}),n.open()}};return a(Ee,{children:p(M,{layout:"vertical",children:[a(M.Item,{htmlFor:"textBox",label:"Post",children:a(K.TextArea,{id:"textBox",maxLength:Et,onChange:c=>T(c),placeholder:"Write your custom post",showCount:!0,style:{height:120,resize:"none"},value:e.templates.linkedin.content})}),a(R,{className:"py-2",children:a(We,{handleCheckBox:I,templateData:e.templates.linkedin,type:s})}),((k=e.templates.linkedin)==null?void 0:k.isLinkCard)&&a(M.Item,{htmlFor:"link",label:"Link",children:a(K,{id:"link",onChange:c=>d(c),placeholder:"https://example.com",value:e.templates.linkedin.link})}),!((o=e.templates.linkedin)!=null&&o.isLinkCard)&&((N=e.templates.linkedin)==null?void 0:N.isAllImages)&&a(Fe,{fileList:e.templates.linkedin.media,listType:"picture-card",onChange:C,openFileDialogOnClick:!1,children:a(te,{placement:"right",title:"Add Image",children:a(P,{onClick:_,style:{height:"100%",width:"100%"},children:p(R,{direction:"vertical",children:[a(W,{name:"upload",size:20}),x("Upload")]})})})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ht({platform:e}){switch(e){case"facebook":return a(Ft,{});case"linkedin":return a(Ut,{})}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Rt({platform:e}){return a(Ht,{platform:e})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Bt=[{label:"Monday",value:"Mon"},{label:"Tuesday",value:"Tue"},{label:"Wednesday",value:"Wed"},{label:"Thursday",value:"Thu"},{label:"Friday",value:"Fri"},{label:"Saturday",value:"Sat"},{label:"Sunday",value:"Sun"}],{dateFormat:$t,timeFormat:Ot,timeZone:Z}=Le(De),zt=`${$t} ${Ot}`,Wt=Ge(zt),{Text:Ne}=q;var Yt={name:"z33n32",styles:"max-width:80px"},Vt={name:"ypff5m",styles:"min-width:100px"};function Qt({isScheduleModal:e,setScheduleModal:t,shareNowModalType:l}){var F,Q;const[s,T]=ee(G),I=Ct(),[d,C]=ee(wt),{isProClient:_}=me(fe),k=H(X(Z)).format("YYYY-MM-DD HH:mm:ss"),o=(f,r)=>{T(A=>L(A,D=>{D.settings={...D.settings,[f]:r}}))},N=()=>{var f;if((f=d==null?void 0:d.startedAt)!=null&&f.length){be.error({message:d.startedAt,placement:"topRight"});return}t(!1)},c=f=>r=>{const A=H(X(Z)).format("YYYY-MM-DD"),D=H(r).format("HH:mm:ss");if(!r){C(E=>({...E,startedAt:""})),o(f,"");return}const Y=(_?r:H(A+D)).format("YYYY-MM-DD HH:mm:ss");if(r&&H(r).diff(X(Z))<1){C(E=>({...E,startedAt:"Start date & time must be grater than local time"})),o(f,Y);return}Y&&(C(E=>({...E,startedAt:""})),o(f,Y))},n=f=>r=>{o(f,r)},m=f=>{const{name:r,value:A}=f.target;o(r,A)},h=f=>(r,A)=>{if(r===null){T(D=>L(D,O=>{delete O.settings.sleep_time}));return}o(f,A)},y=f=>{var r;f||((r=d==null?void 0:d.startedAt)!=null&&r.length&&C(A=>({...A,startedAt:""})),o("started_at",""))};return a(Ue,{centered:!0,footer:[a(P,{onClick:()=>{var f;T(r=>L(r,A=>{A.settings={...A.settings,post_interval_type:"hour",post_interval_value:1,repeat:!1,started_at:void 0},delete A.settings.sleep_time,delete A.settings.sleep_days})),(f=d==null?void 0:d.startedAt)!=null&&f.length&&C(r=>({...r,startedAt:""}))},children:x("Reset")},"reset"),a(P,{onClick:N,type:"primary",children:x("Continue")},"continue")],maskClosable:!1,okButtonProps:{style:{display:"none"}},onCancel:N,open:e,title:l==="edit"?"Edit schedule":"Schedule",width:580,children:p(M,{layout:"vertical",children:[a(M.Item,{label:"Start date & time",children:p(R,{direction:"vertical",children:[a(Tt,{handleOnClear:y,onChangeDate:c,stateData:s,type:"SHARENOW"}),d.startedAt&&p(Ne,{type:"danger",children:[d.startedAt," "]}),a(Ne,{mark:!0,children:Je(x("Local time: %s ; Time Zone: (%s)"),H(k).format(Wt),Z)})]})}),p(R,{className:"fw-sb pb-2",children:[a(te,{placement:"bottomLeft",title:"Please, insert a valid start date & time first!",children:a(tt,{defaultChecked:s.settings.repeat,disabled:!s.settings.started_at,onChange:f=>o("repeat",f),size:"small",value:s.settings.repeat})}),x("Repeat")]}),a(M.Item,{label:"Post interval",style:{margin:"10px 0"},children:p(R,{children:[a(K,{css:Yt,disabled:!s.settings.repeat,min:1,name:"post_interval_value",onChange:m,type:"number",value:s.settings.post_interval_value}),a(ge,{css:Vt,disabled:!s.settings.repeat,onChange:n("post_interval_type"),options:I,value:s.settings.post_interval_type})]})}),s.id&&s.settings.started_at&&H(s.settings.started_at).diff(X(Z))<1&&a(at,{message:p($,{children:[x("If your start time has passed, updating the interval will set your next post to local time plus the new interval! For example, current time 06:00 PM, updated Post interval:2 hours. Next post will be at 08:00 PM."),a(q.Link,{href:"https://bit-social.com/docs/bit-social/instantly-share-posts-on-social-media-platforms/#if-you-update-your-post-interval",rel:"noopener noreferrer",target:"_blank",underline:!0,children:x("Visit our documentation")})]}),showIcon:!0,type:"info"}),a(M.Item,{label:"Set a sleep timer",children:a(st.RangePicker,{disabled:!s.settings.repeat,format:"HH:mm",onChange:h("sleep_time"),value:(F=s.settings.sleep_time)!=null&&F[0]&&((Q=s.settings.sleep_time)!=null&&Q[1])?[H(s.settings.sleep_time[0],"HH:mm"),H(s.settings.sleep_time[1],"HH:mm")]:void 0})}),a(M.Item,{label:"Set sleep days",children:a(ge,{allowClear:!0,disabled:!s.settings.repeat,mode:"multiple",onChange:n("sleep_days"),options:Bt,placeholder:"Select sleep days",value:s.settings.sleep_days})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ie=(e,t="success")=>{be[t]({description:e,duration:3,message:"Share Now"})},Ie=(e,t)=>{const l=e[t];return!(!e.media.length&&!(l!=null&&l.length))},je=3;function qt({shareNowModalClose:e,shareNowModalType:t}){var ye,Se;const[l,s]=B.useState(!1),[T,I]=B.useState(),[d,C]=B.useState({}),[_,k]=B.useState(),[o,N]=ee(G),{createShareNow:c,isCreateShareNowLoading:n}=Lt(),{isUpdateShareNowLoading:m,updateShareNow:h}=Dt(),{accounts:y}=mt(),{groups:j}=ft(),[F,Q]=it.useMessage(),[f]=Re({}),r=Number(f.get("page"))||1,A=Number(f.get("limit"))||10,{refetchShareNowList:D}=Oe(r,A),O=!!Object.keys(d).length||!1,Y=()=>{s(!0)},E=B.useMemo(()=>{var z;const g=o.accounts.accountIds,S=bt(j,(z=o.accounts)==null?void 0:z.groupIds),v=[...g,...S],U=kt(y,v),he=U.map(w=>({children:a(Rt,{platform:w}),key:w,label:a("span",{title:w,children:a(gt,{name:w,size:32})})}));return I(U[0]),N(w=>L(w,de=>{de.platforms=U})),he},[o.accounts.accountIds,(ye=o.accounts)==null?void 0:ye.groupIds]),ce=g=>N(S=>L(S,v=>{v.accounts={accountIds:g.accountIds,groupIds:g==null?void 0:g.groupIds}})),re=(g,S)=>{const v=[],{platforms:U}=g,he=U.length===1;if(g.platforms.length>1&&U.map(z=>{const{requirement:w}=S[z];if(!Ie(g.templates[z],w==null?void 0:w.type))return v.push(!0),F.open({content:w==null?void 0:w.message,type:"error"})}),he){const z=U[0],{requirement:w}=S[z];Ie(g.templates[z],w==null?void 0:w.type)||(v.push(!0),F.open({content:w==null?void 0:w.message,type:"error"}))}return v.length&&!0||!1},ae=g=>{const{name:S}=g.settings;return S===""?(F.open({content:"Title empty",type:"error"}),!0):(d&&_e(d),!!re(g,At))},le=async()=>{if(k("PUBLISH"),ae(o)){k(void 0);return}if(_e(d),t==="edit"){const{data:S,status:v}=await h(o);ie(S,v)}else{const{data:S,status:v}=await c(o);D(),ie(S,v)}e()},i=g=>{N({...o}),I(g)},b=g=>{const{value:S}=g.target;N(v=>L(v,U=>{U.settings={...U.settings,name:S}}))},u=async()=>{if(k("DRAFT"),ae(o)){k(void 0);return}if(t==="edit"){const{data:S,status:v}=await h({...o,isDraft:!0});D(),ie(S,v)}else{const{data:S,status:v}=await c({...o,isDraft:!0});D(),ie(S,v)}e()},V=()=>Object.keys(d).map(g=>{const{text:S}=d[g];return p("div",{children:[" ",p("p",{children:[a("b",{children:g}),": ",S]})]},g)}),Ye=()=>a("div",{children:V()});B.useEffect(()=>()=>{C({})},[]);const Ve=()=>{var g;return t==="edit"&&o.status===je?"Update & Publish":t==="edit"?"Update":(g=o.settings.started_at)!=null&&g.length?"Create":"Publish Now"},Qe=()=>t==="edit"&&o.status===je?"Update draft":"Draft";return p($,{children:[Q,p(Me,{gutter:20,children:[p(ne,{span:7,children:[p(Ae,{className:"mb-1",justify:"space-between",children:[p(q.Title,{level:5,children:[" ",x("Accounts")," "]}),y.length?a(ve,{}):""]}),y!=null&&y.length&&o.accounts?a(yt,{selectedAccount:o.accounts,setSelectedAccount:ce}):p($,{children:[a(St,{iconSize:40,textLevel:5}),a("div",{style:{textAlign:"center"},children:a(ve,{})})]})]}),a(ne,{span:17,children:a("div",{style:{minHeight:"100%"},children:E&&E.length?p($,{children:[a("div",{children:a(M,{layout:"vertical",children:a(M.Item,{htmlFor:"name",label:"Title",children:a(K,{id:"name",onChange:b,placeholder:`Untitled Share Now
                    `,value:(Se=o.settings)==null?void 0:Se.name})})})}),a(nt,{activeKey:T,items:E,onChange:i,size:"small",tabBarGutter:2}),p(Ae,{align:"center",className:"mt-3",gap:8,justify:"end",children:[Object.keys(d).length?a(ot,{content:Ye(),defaultOpen:!0,title:"Something went wrong!",trigger:"click",children:a(P,{danger:!0,icon:a(W,{name:"loader-circle"}),type:"primary"})}):"",a("div",{className:"pr-2",children:a(He,{type:"message"})}),a(P,{disabled:O||_==="PUBLISH",loading:_==="DRAFT"&&(n||m),onClick:u,type:"dashed",children:Qe()}),a(P,{disabled:O,onClick:Y,children:t==="edit"?"Edit Schedule":"Setup Schedule"}),a(P,{disabled:O||_==="DRAFT",loading:_==="PUBLISH"&&(n||m),onClick:()=>le(),type:"primary",children:Ve()})]})]}):a("img",{alt:"account select",className:"w-100",src:Pt})})})]}),l&&a(Qt,{isScheduleModal:l,setScheduleModal:s,shareNowModalType:t})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Pe={open:!1,type:void 0};function ga(){const[e,t]=B.useState(Pe),l=()=>{t(Pe)};return p($,{children:[a(jt,{setShareNowModal:t}),e.open?a(Ue,{centered:!0,footer:!1,maskClosable:!1,onCancel:l,open:e.open,styles:{body:{height:"calc(100vh - 140px)",marginInline:-24,overflow:"auto",padding:0}},title:e.type==="edit"?"Edit Share Now":"Share Now",width:"70%",children:a("div",{style:{paddingInline:24},children:a(qt,{shareNowModalClose:l,shareNowModalType:e.type})})}):""]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{ga as default};
