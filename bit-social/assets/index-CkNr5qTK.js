import{f as H,p as y,c as N,r as F,a,j as e,L as b,F as A,h as Q,u as V,b as J,d as X}from"./main-afraid-ants-sort.js";import{u as Z,a as ee}from"./useMemoDebounce-DLzpEz7x.js";import{u as te}from"./usePostTypes-CNLK-mKL.js";import{u as se,C as L}from"./groupHelper-PveggK-o.js";import{u as oe,F as ae,A as ne}from"./useIntervalTypes-DAAt_mng.js";import{u as ie,b as ce}from"./react-query-BAnB2mAm.js";import{L as le}from"./router-yX2GsLRQ.js";import{t as $,h as c,B as re,S as p,m as u,F as h,T as j,v as ue,i as w,g as E,u as P,I as he,j as pe,s as de}from"./antd-CMhliQbc.js";import"./css-in-js-5B1lZlTz.js";import"./PlatformIcon-DHlKQsTj.js";function ge(s){const t=H(s,(n,l,d)=>l(t,y(n(t),typeof d=="function"?d:()=>d)));return t}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};const me={accounts:{accountIds:[],groupIds:[]},isEnabled:!1,keepLogs:!0,postDelay:{every:0,unit:""},postType:["post"],taxonomies:["categories","tags"]},D=globalThis.jotaiAtomCache.get("/home/runner/work/bit-social/bit-social/frontend/src/common/globalStates/$autoPostSettings.ts/$autoPostSettings",ge(me));D.debugLabel="$autoPostSettings";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};function ye(){const s=N(D),{data:t,isLoading:n}=ie({queryFn:async()=>{const{data:l}=await F("autoPostSettings",void 0,void 0,"GET");return l?(s(l),l):[]},queryKey:["autoPostSettings"]});return{autoPostSettings:t,isLoadingAutoPostSettings:n}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};function fe(){const{isPending:s,isSuccess:t,mutateAsync:n}=ce({mutationFn:async l=>F("autoPostSettings/update",{autoPostSettings:l},void 0,"POST"),mutationKey:["autoPostSettingsUpdate"]});return{isSettingsUpdateSuccessfully:t,isUpdatingAutoPostSettings:s,updateAutoPostSettings:n}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};const be="0";function z(s){const{every:t,unit:n}=s;return t===0&&n===""?"immediately":"delay"}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};const{Title:Ae}=j;function Te(){const{token:s}=$.useToken();return a(A,{children:[e(Ae,{level:5,children:"Post templates"}),a(c,{actions:[e(le,{to:"/templates",children:e(re,{type:"primary",children:a(p,{align:"center",size:2,children:[e("div",{children:"Templates"}),e(b,{name:"move-up-right"})]})})},"template")],style:{borderColor:s.colorBorder},styles:{body:{height:"380px",width:"80%"}},children:[a(p,{className:"py-2",children:[e(u.Avatar,{size:"large"}),e(u.Input,{size:"small"})]}),e(u,{}),e(u.Image,{}),a(h,{className:"py-3",gap:10,justify:"space-around",children:[e(u.Button,{size:"small"}),e(u.Button,{size:"small"}),e(u.Button,{size:"small"})]})]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};const{Link:Se,Paragraph:ve,Text:C,Title:we}=j;var Pe={name:"p4355k",styles:"min-width:180px"},Ce={name:"m0jwvv",styles:"width:80px"},je={name:"ypff5m",styles:"min-width:100px"};function $e(){const{token:s}=$.useToken(),[t,n]=Q(D),{isSettingsUpdateSuccessfully:l,isUpdatingAutoPostSettings:d,updateAutoPostSettings:B}=fe(),{isLoadingAutoPostSettings:T}=ye(),[M,U]=ue.useMessage(),{accounts:x}=se(),{isProClient:f}=V(J),I=N(X),Y=oe(),{loadingPostType:O,postTypes:k}=te(),_=k&&Object.values(k).map(o=>({label:a(A,{children:[o.label," ",o.name!=="post"&&!f&&e(b,{color:"#ff8609",name:"crown",size:16})]}),value:o.name}));Z(async()=>{const{status:o}=await B(t);l&&o&&ee(M,o)},400,[t]);const g=(o,i)=>{const{accounts:r,isEnabled:S}=t,G=!r.accountIds.length;if(o==="isEnabled"&&G&&!S){de.warning({message:"Create and select an account first!",placement:"topRight"});return}if(!f&&o==="postType"&&Array.isArray(i)&&i.length&&i.includes("post")){I(!0);return}if(o==="postType"&&Array.isArray(i)&&!i.length){n(m=>y(m,v=>{v.postType=["post"]})),M.open({content:"You must have a type",type:"warning"});return}if(!f&&o==="postDelay"&&i!==be){I(!0);return}if(o==="postDelay"){n(m=>y(m,v=>{v.postDelay=i==="delay"?{every:1,unit:"minute"}:{every:0,unit:""}}));return}n(m=>({...m,[o]:i}))},q=o=>{g("accounts",o)},W=o=>{const{value:i}=o.target;n(r=>y(r,S=>{S.postDelay.every=Number(i)}))},K=o=>{n(i=>y(i,r=>{o!==""&&t.postDelay.every<1&&(r.postDelay.every=1),o===""&&(r.postDelay.every=0),r.postDelay.unit=o}))},R=[{label:"Immediately",value:"immediately"},{label:a(A,{children:["Delay ",!f&&e(b,{color:"#ff8609",name:"crown",size:16})]}),value:"delay"}];return a(pe,{gutter:20,children:[U,a(w,{span:6,children:[a(h,{className:"mb-1",justify:"space-between",children:[e(j.Title,{level:5,children:"Accounts"}),x.length?e(L,{}):""]}),x.length?e(ae,{isLoading:d,selectedAccount:t.accounts,setSelectedAccount:q}):a(A,{children:[e(ne,{iconSize:40,textLevel:5}),e("div",{style:{textAlign:"center"},children:e(L,{})})]})]}),e(w,{span:12,children:a(c,{style:{backgroundColor:s.colorFillAlter},children:[e(we,{level:4,children:"Auto Post Settings"}),a(ve,{children:["All auto post related settings here.",a(Se,{className:"pl-2",href:"https://bit-social.com/docs/auto-publish-wordpress-posts-on-social-media/",rel:"noopener noreferrer nofollow",target:"_blank",underline:!0,children:["Doc here",e(b,{name:"move-up-right",size:12,style:{transform:"translateY(-2px)"}})]})]}),a(c,{style:{marginTop:10},children:[a(h,{gap:50,justify:"space-between",children:[e(c.Meta,{description:"When you publish a new wordpress post, the plugin shares the post on all active social accounts automatically.",title:"Share posts automatically"}),e("div",{children:e(E,{checked:t.isEnabled,disabled:T,onChange:o=>g("isEnabled",o)})})]}),e(p,{className:"pt-2",children:e(C,{mark:!0,children:"You have to create and select account first to enable this option!"})})]}),a(c,{style:{marginTop:10},children:[a(h,{gap:50,justify:"space-between",children:[e(c.Meta,{description:"Automatically share specific post types, like blogs or products, to your social accounts when published.",title:"Share posts type"}),e("div",{children:e(P,{allowClear:!0,loading:T||O,mode:"multiple",onChange:o=>g("postType",o),options:_,placeholder:"Post Type: Post",style:{minWidth:"150px"},value:t.postType})})]}),e(p,{className:"pt-2",children:a(C,{mark:!0,children:["Share posts default type ",e("b",{children:"Post"})]})})]}),e(c,{style:{marginTop:10},children:a(h,{gap:50,justify:"space-between",children:[e(c.Meta,{description:"Optimize your sharing strategy with flexible timing options: use the dropdown menu to select when your posts will be shared after publishing",title:"Share post delay"}),a(h,{gap:20,vertical:!0,children:[e(p,{children:e(P,{css:Pe,onChange:o=>g("postDelay",o),options:R,value:z(t.postDelay)})}),z(t.postDelay)==="delay"&&a(p,{className:"w-100",children:[e(he,{css:Ce,min:1,onChange:W,type:"number",value:t.postDelay.every}),e(P,{css:je,onChange:K,options:Y,value:t.postDelay.unit})]})]})]})}),a(c,{style:{marginTop:10},children:[a(h,{gap:50,justify:"space-between",children:[e(c.Meta,{description:"If you don't want to keep the shared post logs, you need to disable the option. Disabling the option prevents you view your insights and you might encounter duplicate posts when you use the schedule module.",title:"Enable auto post log"}),e("div",{children:e(E,{checked:t.keepLogs,disabled:T,onChange:o=>g("keepLogs",o)})})]}),e(p,{className:"pt-2",children:e(C,{mark:!0,children:"You have to create and select account first to enable this option!"})})]})]})}),e(w,{span:6,children:e(Te,{})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(s,t){return this.cache.has(s)?this.cache.get(s):(this.cache.set(s,t),t)}};export{$e as default};
