import{f as qe,r as oe,g as Le,e as De,c as Ke,l as we,m as se,n as X,_ as s,j as a,a as g,L as W,F as $,h as ee,u as me,b as fe,p as L,o as Ge,q as Je}from"./main-plenty-doors-read.js";import{r as B,s as be,z as H,T as q,q as ue,v as ge,B as P,P as Te,S as R,k as Me,j as ne,x as Ze,E as Xe,n as et,J as ke,K as te,o as M,I as K,U as Fe,i as Ee,h as tt,m as at,G as st,M as Ue,w as it,F as Ae,H as nt,N as ot}from"./antd-Dkhz2BjJ.js";import{C as He}from"./CronWarning-CwRxBjLQ.js";import{u as ct,N as rt}from"./useUpdateScheduleStatus-DCzOCLul.js";import{D as lt,R as ht}from"./Refresh-BuaHVLqa.js";import{u as Re}from"./router-BDBqwsZt.js";import{a as Be,b as Ce,u as dt,k as ut,Q as pt}from"./react-query-B4O-PG_a.js";import{P as gt}from"./PlatformIcon-nT1RWFgS.js";import{u as mt,a as ft,g as bt,C as ve}from"./groupHelper-DRF28X9S.js";import{u as Ct,F as yt,A as St}from"./useIntervalTypes--1bNiVZ0.js";import{b as wt,D as Tt,g as kt}from"./DatePicker-C_Ae06qk.js";import{p as At}from"./TemplateDocLink-DJQgQTBc.js";import"./ProGoogleBusinessProfileSettings-Dw5tEh-U.js";import"./css-in-js-D9KZUreV.js";import"./useSocialTemplates-DyNqVUWx.js";import"./index-0DjDwEVr.js";import"./useMemoDebounce-DQpEIied.js";import"./useUpdateSocialTemplates-DuGe1nX-.js";import"./PreviewDummy-B_FhnD8B.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const $e=()=>({accounts:{accountIds:[],groupIds:[]},platforms:[],settings:{name:"",post_interval_type:"hour",post_interval_value:1,repeat:!1,started_at:void 0},templates:{all:{content:"",isLinkCard:!1,link:"",media:[]},discord:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},facebook:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},googleBusinessProfile:{button:"none",content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},instagram:{comment:"",content:"",edit:!1,isAllImages:!0,media:[]},linkedin:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},pinterest:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},tumblr:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]},twitter:{content:"",edit:!1,isAllImages:!1,isLinkCard:!1,link:"",media:[]}}}),G=globalThis.jotaiAtomCache.get("/home/runner/work/bit-social/bit-social/frontend/src/common/globalStates/$shareNowData.ts/$shareNowData",qe($e()));G.debugLabel="$shareNowData";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function vt(e,t){const h=Be(),{isPending:i,mutateAsync:k}=Ce({mutationFn:async I=>oe("share-now/destroy/batch",{shareNowIds:I},void 0,"POST"),onSuccess:()=>{h.invalidateQueries({queryKey:["share-now",[t,e]]})}});return{deleteShareNow:I=>k(I),isShareNowDeleting:i}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Oe(e,t){const{data:h,isFetching:i,isLoading:k,refetch:I}=dt({enabled:!!t&&!!e,placeholderData:ut,queryFn:async()=>oe(`share-now/${e}/${t}`,void 0,void 0,"GET"),queryKey:["share-now",[e,t]],refetchInterval:5e3}),{current_page:u,current_total:y,data:_,pages:A,per_page:c,total:N}=(h==null?void 0:h.data)||{};return{currentPage:u,currentTotal:y,isFetchingShareNowList:i,isLoadingShareNowList:k,perPage:c,refetchShareNowList:I,shareNowData:_||[],totalPages:A,totalShareNow:N}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const xt=({token:e})=>({background:e.colorSuccessBg,border:`1px solid ${e.colorSuccessBorder}`,borderRadius:"10px",color:e.colorSuccessText,minWidth:"90px"}),_t=({token:e})=>({background:e.colorWarningBg,border:`1px solid ${e.colorWarningBorder}`,borderRadius:"10px",color:e.colorWarningText,minWidth:"90px"}),pe=0,J=1,xe=2,Nt=3,It=4;function jt({setShareNowModal:e}){const[t,h]=Re({}),i=Number(t.get("page"))||1,k=Number(t.get("limit"))||10,{timeZone:I}=Le(De),{isFetchingShareNowList:u,isLoadingShareNowList:y,refetchShareNowList:_,shareNowData:A,totalPages:c,totalShareNow:N}=Oe(i,k),[r,o]=B.useState([]),{updateScheduleStatus:f}=ct(),{deleteShareNow:d,isShareNowDeleting:S}=vt(k,i),j=Ke(G),[F,Q]=be.useNotification(),b=(n,C="success")=>{F[C]({description:n,message:"Share Now"})},l=A.map(n=>({created_at:we(n.created_at,`${se.DATE_FORMAT} ${se.TIME_FORMAT}`),interval:n.config,key:n.id,nextPost:n.next_published_at&&n.status===1&&H(n.next_published_at).diff(X(I))>1?n.human_readable_next_publish:"-",start:n!=null&&n.config.settings.started_at?we(n==null?void 0:n.config.settings.started_at,`${se.DATE_FORMAT} ${se.TIME_FORMAT}`):"-",status:n.status,title:n.name})),v=async(n,C)=>{const{data:p,status:V}=await f({id:n,status:C});b(p,V),_()},D=()=>{j($e()),e({open:!0,type:"create"})},O=async n=>{await d([n]),_()},Y=n=>{const C=A.find(p=>p.id===n);C&&(j(p=>({...p,accounts:C.config.accounts,id:n,settings:C.config.settings,status:C.status,templates:C.config.templates})),e({open:!0,type:"edit"}))},E=[{dataIndex:"title",key:"title",title:s("Title"),width:"20%"},{dataIndex:"created_at",key:"created_at",title:s("Created At")},{dataIndex:"start",key:"start",title:s("Start Scheduled Post")},{dataIndex:"interval",key:"interval",render:(n,{interval:C})=>a(q.Text,{children:C.settings.repeat?`${C.settings.post_interval_value} ${C.settings.post_interval_type}`:"-"}),title:s("Interval ")},{dataIndex:"nextPost",key:"nextPost",title:s("Next Post ")},{dataIndex:"status",key:"status",render:(n,{key:C,status:p})=>{switch(p){case J:case pe:return a(ge,{css:p===J?xt:_t,onChange:V=>v(C,Number(V)),options:[{disabled:p===J,label:s("Active"),value:J},{disabled:p===pe,label:s("Paused"),value:pe}],size:"small",value:p===J?"Active":"Paused",variant:"borderless"});case xe:return a(ue,{color:"grey",children:s("Completed")});case Nt:return a(ue,{color:"purple",children:s("Draft")});case It:return a(ue,{color:"red",children:s("Missed")})}},title:s("Status")},{dataIndex:"action",key:"action",render:(n,{key:C,status:p})=>g(R,{direction:"horizontal",children:[p!==xe&&a(P,{icon:a(W,{name:"pencil"}),onClick:()=>Y(C),type:"text"}),a(Te,{description:s("Are you sure you want to delete this schedule?"),okButtonProps:{danger:!0,loading:S},okText:s("Yes, Delete"),onConfirm:()=>O(C),placement:"right",title:s("Delete?"),children:a(P,{danger:!0,icon:a(W,{name:"trash-2"}),type:"text"})})]}),title:s("Action ")}],ce=(n,C)=>{h(p=>(p.set("page",String(n)),p.set("limit",String(C)),p))},re={onSelect:(n,C)=>{if(n){if(C){o(p=>[...p,n.key]);return}o(p=>p.filter(V=>V!==n.key))}},onSelectAll:(n,C)=>{if(n){o(C.map(p=>p==null?void 0:p.key).filter(p=>p!==void 0));return}o([])}},ae=r.length>0,le=async()=>{await d(r),o([]),_()};return B.useEffect(()=>{!A.length&&c&&i>c&&h(n=>(n.set("page",String(c)),n))},[A]),g($,{children:[Q,g(Me,{className:"mb-2",justify:"space-between",children:[a(ne,{children:a(R,{children:ae?g($,{children:[a(q.Text,{children:`Selected ${r.length} items`}),a(Te,{description:s("Are you sure to delete this logs?"),okText:s("Confirm"),onConfirm:le,placement:"right",title:s("Delete Logs"),children:a(P,{danger:!0,icon:a(lt,{}),type:"text"})})]}):void 0})}),a(ne,{children:l!=null&&l.length?g(R,{children:[g(q.Link,{href:"https://bit-social.com/docs/instantly-share-posts-on-social-media-platforms/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[s("How to share a post instantly"),a(W,{name:"move-up-right",style:{transform:"translateY(-2px)"}})]}),a(P,{disabled:y||u,icon:a(ht,{spin:y||u}),onClick:()=>_(),size:"large",children:s("Refresh")}),a(P,{icon:a(W,{name:"plus"}),onClick:D,size:"large",type:"primary",children:s("Share Post")})]}):void 0})]}),l!=null&&l.length?g($,{children:[a(He,{}),a(Ze,{bordered:!0,className:"mt-1",columns:E,dataSource:l,pagination:{current:i,defaultCurrent:1,onChange:ce,pageSize:k,showSizeChanger:!0,total:N},rowSelection:re})]}):void 0,!y&&!(l!=null&&l.length)?a(Xe,{description:s("No Share Post found!"),children:a(P,{icon:a(W,{name:"plus"}),onClick:D,size:"large",type:"primary",children:s("Share Post")})}):void 0,y&&a(et,{}),!y&&!(l!=null&&l.length)?a(rt,{fontSize:"1.6rem",section:"shareNow",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}const Pt=""+new URL("bit-social-ba-assets-734.svg",import.meta.url).href;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Lt(){const e=new pt,{isPending:t,isSuccess:h,mutateAsync:i}=Ce({mutationFn:async k=>oe("share-now",{...k},void 0,"POST"),onSuccess:()=>{e.invalidateQueries({queryKey:["all-schedules"]}),e.invalidateQueries({queryKey:["get-calendar-schedules"]}),e.invalidateQueries({queryKey:["share-now"]})}});return{createShareNow:i,isCreateShareNowLoading:t,isShareNowSuccess:h}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Dt(){const e=Be(),{isPending:t,mutateAsync:h}=Ce({mutationFn:async i=>oe(`share-now/${i.id}/update`,{...i},void 0,"POST"),onSuccess:()=>{e.invalidateQueries({queryKey:["share-now",[1,10]]})}});return{isUpdateShareNowLoading:t,updateShareNow:h}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const _e=e=>{for(const t in e)if(e.hasOwnProperty(t)){const h=e[t];if(h.text||h.media.length)return!0}return!1};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ze=e=>({name:e.filename,uid:e.id,url:e.url});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function We({handleCheckBox:e,templateData:t,type:h}){return g($,{children:[h.includes("isLinkCard")&&a(te,{title:s("Enable to the link shared as a card"),children:a(ke,{checked:t.isLinkCard,onChange:i=>{e("isLinkCard",i.target.checked)},children:s("Link")})}),h.includes("isAllImages")&&a(te,{title:s("Enable to selected image shared"),children:a(ke,{checked:t.isAllImages,onChange:i=>{e("isAllImages",i.target.checked)},children:s("Media")})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Mt=3e3;function Ft(){var A,c,N;const[e,t]=ee(G),{isProClient:h}=me(fe),i=["isLinkCard","isAllImages"],k=r=>{t(o=>L(o,f=>{f.templates.facebook.content=r.target.value}))},I=(r,o)=>{t(f=>L(f,d=>{d.templates.facebook.isLinkCard=!1,d.templates.facebook.isAllImages=!1,d.templates.facebook[r]=o}))},u=r=>{const{value:o}=r.target;t(f=>L(f,d=>{d.templates.facebook.link=o}))},y=({fileList:r})=>{const o=L(e,f=>{f.templates.facebook.media=r});t(o)},_=()=>{const r=["image/jpg","image/jpeg","image/png","image/webp"];if(typeof wp<"u"&&wp.media){const o=wp.media({button:{text:"Select Image"},library:{type:r},multiple:h?"add":!1,title:s("Media")}),f=e.templates.facebook.media.map(d=>d.uid);o.on("open",()=>{const d=o.state().get("selection");f.forEach(S=>{const j=wp.media.attachment(S);j.fetch().done(()=>{d.add(j)})})}),o.on("select",()=>{const d=o.state().get("selection").toJSON();let S=[];S=d.map(F=>ze(F));const j=S.at(-1)||{};y({file:j,fileList:S})}),o.open()}};return a(Ee,{children:g(M,{layout:"vertical",children:[a(M.Item,{htmlFor:"textBox",label:s("Post"),children:a(K.TextArea,{id:"textBox",maxLength:Mt,onChange:r=>k(r),placeholder:s("Write your custom post"),showCount:!0,style:{height:120,resize:"none"},value:e.templates.facebook.content})}),a(R,{className:"py-2",children:a(We,{handleCheckBox:I,templateData:e.templates.facebook,type:i})}),((A=e.templates.facebook)==null?void 0:A.isLinkCard)&&a(M.Item,{htmlFor:"link",label:s("Link"),children:a(K,{id:"link",onChange:r=>u(r),placeholder:s("https://example.com"),value:e.templates.facebook.link})}),!((c=e.templates.facebook)!=null&&c.isLinkCard)&&((N=e.templates.facebook)==null?void 0:N.isAllImages)&&a(Fe,{fileList:e.templates.facebook.media,listType:"picture-card",onChange:y,openFileDialogOnClick:!1,children:a(te,{placement:"right",title:s("Add Image"),children:a(P,{onClick:_,style:{height:"100%",width:"100%"},children:g(R,{direction:"vertical",children:[a(W,{name:"upload",size:20}),s("Upload")]})})})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Et=3e3;function Ut(){var A,c,N;const[e,t]=ee(G),{isProClient:h}=me(fe),i=["isLinkCard","isAllImages"],k=r=>{t(o=>L(o,f=>{f.templates.linkedin.content=r.target.value}))},I=(r,o)=>{t(f=>L(f,d=>{d.templates.linkedin.isLinkCard=!1,d.templates.linkedin.isAllImages=!1,d.templates.linkedin[r]=o}))},u=r=>{const{value:o}=r.target;t(f=>L(f,d=>{d.templates.linkedin.link=o}))},y=({fileList:r})=>{const o=L(e,f=>{f.templates.linkedin.media=r});t(o)},_=()=>{const r=["image/jpg","image/jpeg","image/png","image/webp"];if(typeof wp<"u"&&wp.media){const o=wp.media({button:{text:"Select Image"},library:{type:r},multiple:h?"add":!1,title:s("Media")}),f=e.templates.linkedin.media.map(d=>d.uid);o.on("open",()=>{const d=o.state().get("selection");f.forEach(S=>{const j=wp.media.attachment(S);j.fetch().done(()=>{d.add(j)})})}),o.on("select",()=>{const d=o.state().get("selection").toJSON();let S=[];S=d.map(F=>ze(F));const j=S.at(-1)||{};y({file:j,fileList:S})}),o.open()}};return a(Ee,{children:g(M,{layout:"vertical",children:[a(M.Item,{htmlFor:"textBox",label:s("Post"),children:a(K.TextArea,{id:"textBox",maxLength:Et,onChange:r=>k(r),placeholder:s("Write your custom post"),showCount:!0,style:{height:120,resize:"none"},value:e.templates.linkedin.content})}),a(R,{className:"py-2",children:a(We,{handleCheckBox:I,templateData:e.templates.linkedin,type:i})}),((A=e.templates.linkedin)==null?void 0:A.isLinkCard)&&a(M.Item,{htmlFor:"link",label:s("Link"),children:a(K,{id:"link",onChange:r=>u(r),placeholder:s("https://example.com"),value:e.templates.linkedin.link})}),!((c=e.templates.linkedin)!=null&&c.isLinkCard)&&((N=e.templates.linkedin)==null?void 0:N.isAllImages)&&a(Fe,{fileList:e.templates.linkedin.media,listType:"picture-card",onChange:y,openFileDialogOnClick:!1,children:a(te,{placement:"right",title:s("Add Image"),children:a(P,{onClick:_,style:{height:"100%",width:"100%"},children:g(R,{direction:"vertical",children:[a(W,{name:"upload",size:20}),s("Upload")]})})})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ht({platform:e}){switch(e){case"facebook":return a(Ft,{});case"linkedin":return a(Ut,{})}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Rt({platform:e}){return a(Ht,{platform:e})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Bt=[{label:s("Monday"),value:"Mon"},{label:s("Tuesday"),value:"Tue"},{label:s("Wednesday"),value:"Wed"},{label:s("Thursday"),value:"Thu"},{label:s("Friday"),value:"Fri"},{label:s("Saturday"),value:"Sat"},{label:s("Sunday"),value:"Sun"}],{dateFormat:$t,timeFormat:Ot,timeZone:Z}=Le(De),zt=`${$t} ${Ot}`,Wt=Ge(zt),{Text:Ne}=q;var Yt={name:"z33n32",styles:"max-width:80px"},Vt={name:"ypff5m",styles:"min-width:100px"};function Qt({isScheduleModal:e,setScheduleModal:t,shareNowModalType:h}){var F,Q;const[i,k]=ee(G),I=Ct(),[u,y]=ee(wt),{isProClient:_}=me(fe),A=H(X(Z)).format("YYYY-MM-DD HH:mm:ss"),c=(b,l)=>{k(v=>L(v,D=>{D.settings={...D.settings,[b]:l}}))},N=()=>{var b;if((b=u==null?void 0:u.startedAt)!=null&&b.length){be.error({message:u.startedAt,placement:"topRight"});return}t(!1)},r=b=>l=>{const v=H(X(Z)).format("YYYY-MM-DD"),D=H(l).format("HH:mm:ss");if(!l){y(E=>({...E,startedAt:""})),c(b,"");return}const Y=(_?l:H(v+D)).format("YYYY-MM-DD HH:mm:ss");if(l&&H(l).diff(X(Z))<1){y(E=>({...E,startedAt:"Start date & time must be grater than local time"})),c(b,Y);return}Y&&(y(E=>({...E,startedAt:""})),c(b,Y))},o=b=>l=>{c(b,l)},f=b=>{const{name:l,value:v}=b.target;c(l,v)},d=b=>(l,v)=>{if(l===null){k(D=>L(D,O=>{delete O.settings.sleep_time}));return}c(b,v)},S=b=>{var l;b||((l=u==null?void 0:u.startedAt)!=null&&l.length&&y(v=>({...v,startedAt:""})),c("started_at",""))};return a(Ue,{centered:!0,footer:[a(P,{onClick:()=>{var b;k(l=>L(l,v=>{v.settings={...v.settings,post_interval_type:"hour",post_interval_value:1,repeat:!1,started_at:void 0},delete v.settings.sleep_time,delete v.settings.sleep_days})),(b=u==null?void 0:u.startedAt)!=null&&b.length&&y(l=>({...l,startedAt:""}))},children:s("Reset")},"reset"),a(P,{onClick:N,type:"primary",children:s("Continue")},"continue")],maskClosable:!1,okButtonProps:{style:{display:"none"}},onCancel:N,open:e,title:h==="edit"?s("Edit schedule"):s("Schedule"),width:580,children:g(M,{layout:"vertical",children:[a(M.Item,{label:s("Start date & time"),children:g(R,{direction:"vertical",children:[a(Tt,{handleOnClear:S,onChangeDate:r,stateData:i,type:"SHARENOW"}),u.startedAt&&g(Ne,{type:"danger",children:[u.startedAt," "]}),a(Ne,{mark:!0,children:Je(s("Local time: %s ; Time Zone: (%s)"),H(A).format(Wt),Z)})]})}),g(R,{className:"fw-sb pb-2",children:[a(te,{placement:"bottomLeft",title:s("Please, insert a valid start date & time first!"),children:a(tt,{defaultChecked:i.settings.repeat,disabled:!i.settings.started_at,onChange:b=>c("repeat",b),size:"small",value:i.settings.repeat})}),s("Repeat")]}),a(M.Item,{label:s("Post interval"),style:{margin:"10px 0"},children:g(R,{children:[a(K,{css:Yt,disabled:!i.settings.repeat,min:1,name:"post_interval_value",onChange:f,type:"number",value:i.settings.post_interval_value}),a(ge,{css:Vt,disabled:!i.settings.repeat,onChange:o("post_interval_type"),options:I,value:i.settings.post_interval_type})]})}),i.id&&i.settings.started_at&&H(i.settings.started_at).diff(X(Z))<1&&a(at,{message:g($,{children:[s("If your start time has passed, updating the interval will set your next post to local time plus the new interval! For example, current time 06:00 PM, updated Post interval:2 hours. Next post will be at 08:00 PM."),a(q.Link,{href:"https://bit-social.com/docs/bit-social/instantly-share-posts-on-social-media-platforms/#if-you-update-your-post-interval",rel:"noopener noreferrer",target:"_blank",underline:!0,children:s("Visit our documentation")})]}),showIcon:!0,type:"info"}),a(M.Item,{label:s("Set a sleep timer"),children:a(st.RangePicker,{disabled:!i.settings.repeat,format:"HH:mm",onChange:d("sleep_time"),value:(F=i.settings.sleep_time)!=null&&F[0]&&((Q=i.settings.sleep_time)!=null&&Q[1])?[H(i.settings.sleep_time[0],"HH:mm"),H(i.settings.sleep_time[1],"HH:mm")]:void 0})}),a(M.Item,{label:s("Set sleep days"),children:a(ge,{allowClear:!0,disabled:!i.settings.repeat,mode:"multiple",onChange:o("sleep_days"),options:Bt,placeholder:s("Select sleep days"),value:i.settings.sleep_days})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ie=(e,t="success")=>{be[t]({description:e,duration:3,message:"Share Now"})},Ie=(e,t)=>{const h=e[t];return!(!e.media.length&&!(h!=null&&h.length))},je=3;function qt({shareNowModalClose:e,shareNowModalType:t}){var ye,Se;const[h,i]=B.useState(!1),[k,I]=B.useState(),[u,y]=B.useState({}),[_,A]=B.useState(),[c,N]=ee(G),{createShareNow:r,isCreateShareNowLoading:o}=Lt(),{isUpdateShareNowLoading:f,updateShareNow:d}=Dt(),{accounts:S}=mt(),{groups:j}=ft(),[F,Q]=it.useMessage(),[b]=Re({}),l=Number(b.get("page"))||1,v=Number(b.get("limit"))||10,{refetchShareNowList:D}=Oe(l,v),O=!!Object.keys(u).length||!1,Y=()=>{i(!0)},E=B.useMemo(()=>{var z;const m=c.accounts.accountIds,w=bt(j,(z=c.accounts)==null?void 0:z.groupIds),x=[...m,...w],U=kt(S,x),he=U.map(T=>({children:a(Rt,{platform:T}),key:T,label:a("span",{title:T,children:a(gt,{name:T,size:32})})}));return I(U[0]),N(T=>L(T,de=>{de.platforms=U})),he},[c.accounts.accountIds,(ye=c.accounts)==null?void 0:ye.groupIds]),ce=m=>N(w=>L(w,x=>{x.accounts={accountIds:m.accountIds,groupIds:m==null?void 0:m.groupIds}})),re=(m,w)=>{const x=[],{platforms:U}=m,he=U.length===1;if(m.platforms.length>1&&U.map(z=>{const{requirement:T}=w[z];if(!Ie(m.templates[z],T==null?void 0:T.type))return x.push(!0),F.open({content:T==null?void 0:T.message,type:"error"})}),he){const z=U[0],{requirement:T}=w[z];Ie(m.templates[z],T==null?void 0:T.type)||(x.push(!0),F.open({content:T==null?void 0:T.message,type:"error"}))}return x.length&&!0||!1},ae=m=>{const{name:w}=m.settings;return w===""?(F.open({content:"Title empty",type:"error"}),!0):(u&&_e(u),!!re(m,At))},le=async()=>{if(A("PUBLISH"),ae(c)){A(void 0);return}if(_e(u),t==="edit"){const{data:w,status:x}=await d(c);ie(w,x)}else{const{data:w,status:x}=await r(c);D(),ie(w,x)}e()},n=m=>{N({...c}),I(m)},C=m=>{const{value:w}=m.target;N(x=>L(x,U=>{U.settings={...U.settings,name:w}}))},p=async()=>{if(A("DRAFT"),ae(c)){A(void 0);return}if(t==="edit"){const{data:w,status:x}=await d({...c,isDraft:!0});D(),ie(w,x)}else{const{data:w,status:x}=await r({...c,isDraft:!0});D(),ie(w,x)}e()},V=()=>Object.keys(u).map(m=>{const{text:w}=u[m];return g("div",{children:[" ",g("p",{children:[a("b",{children:m}),": ",w]})]},m)}),Ye=()=>a("div",{children:V()});B.useEffect(()=>()=>{y({})},[]);const Ve=()=>{var m;return t==="edit"&&c.status===je?"Update & Publish":t==="edit"?"Update":(m=c.settings.started_at)!=null&&m.length?"Create":"Publish Now"},Qe=()=>t==="edit"&&c.status===je?"Update draft":"Draft";return g($,{children:[Q,g(Me,{gutter:20,children:[g(ne,{span:7,children:[g(Ae,{className:"mb-1",justify:"space-between",children:[g(q.Title,{level:5,children:[" ",s("Accounts")," "]}),S.length?a(ve,{}):""]}),S!=null&&S.length&&c.accounts?a(yt,{selectedAccount:c.accounts,setSelectedAccount:ce}):g($,{children:[a(St,{iconSize:40,textLevel:5}),a("div",{style:{textAlign:"center"},children:a(ve,{})})]})]}),a(ne,{span:17,children:a("div",{style:{minHeight:"100%"},children:E&&E.length?g($,{children:[a("div",{children:a(M,{layout:"vertical",children:a(M.Item,{htmlFor:"name",label:s("Title"),children:a(K,{id:"name",onChange:C,placeholder:s("Untitled Share Now"),value:(Se=c.settings)==null?void 0:Se.name})})})}),a(nt,{activeKey:k,items:E,onChange:n,size:"small",tabBarGutter:2}),g(Ae,{align:"center",className:"mt-3",gap:8,justify:"end",children:[Object.keys(u).length?a(ot,{content:Ye(),defaultOpen:!0,title:s("Something went wrong!"),trigger:"click",children:a(P,{danger:!0,icon:a(W,{name:"loader-circle"}),type:"primary"})}):"",a("div",{className:"pr-2",children:a(He,{type:"message"})}),a(P,{disabled:O||_==="PUBLISH",loading:_==="DRAFT"&&(o||f),onClick:p,type:"dashed",children:Qe()}),a(P,{disabled:O,onClick:Y,children:t==="edit"?s("Edit Schedule"):s("Setup Schedule")}),a(P,{disabled:O||_==="DRAFT",loading:_==="PUBLISH"&&(o||f),onClick:()=>le(),type:"primary",children:Ve()})]})]}):a("img",{alt:"account select",className:"w-100",src:Pt})})})]}),h&&a(Qt,{isScheduleModal:h,setScheduleModal:i,shareNowModalType:t})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Pe={open:!1,type:void 0};function ga(){const[e,t]=B.useState(Pe),h=()=>{t(Pe)};return g($,{children:[a(jt,{setShareNowModal:t}),e.open?a(Ue,{centered:!0,footer:!1,maskClosable:!1,onCancel:h,open:e.open,styles:{body:{height:"calc(100vh - 140px)",marginInline:-24,overflow:"auto",padding:0}},title:e.type==="edit"?s("Edit Share Now"):s("Share Now"),width:"70%",children:a("div",{style:{paddingInline:24},children:a(qt,{shareNowModalClose:h,shareNowModalType:e.type})})}):""]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{ga as default};
