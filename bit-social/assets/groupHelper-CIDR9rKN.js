import{X as _,$,ac as W,w as L,A as Te,q as ae,v as X,y as l,ar as R,z as i,T as m,j as c,F as ee,S as k,B as w,a0 as Fe,D as Q,E as se,r as I,K as O,I as ve,N as ie,c1 as he,ai as G,c2 as Ne,J as te,Y as x,s as Y,G as ke,H as Se,L as Ue,c3 as ue,x as je,c4 as qe,M as de}from"./main-wise-readers-press.js";import{p as ne,P as ce,i as oe}from"./PlatformIcon-C5P4zc8J.js";import{C as b,R as Z}from"./row-oB5Qxk6J.js";import{A as Me}from"./index-CEHDqQPh.js";import{F as D}from"./index-Di9ryO-P.js";import{C as J}from"./index-COiRwlsZ.js";import{A as _e}from"./index-B8anATvx.js";import{s as N}from"./index-dtRlXwts.js";import{P as Oe,F as f}from"./index-CUrkXSrx.js";import{I as F,S as Le}from"./index-L6wc648M.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Re({searchAccountsTxt:e="",selectedMenuTab:t={}}={}){const{isModalOpen:a}=_($),o=[];e&&o.push(e),t.type&&o.push(t);const{data:s,isFetching:h,isLoading:u,refetch:n}=W({queryFn:async()=>L("accounts",void 0,{search:e,...t},"GET"),queryKey:["accounts",...o],refetchInterval:a?2e3:!1});return{accounts:(s==null?void 0:s.data)||[],isFetchingAccounts:h,isLoadingAccounts:u,refetchAccounts:n}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function $e(){const[e]=Te({}),t=e.get("value")||"",o={type:e.get("type")||"",value:t},s=ae(),{isError:h,isPending:u,isSuccess:n,mutateAsync:r}=X({mutationFn:async d=>L("account/save",{accountData:d},void 0,"POST"),mutationKey:["save_account"],onSuccess:()=>{s.invalidateQueries({queryKey:["active-accounts"]}),s.invalidateQueries({queryKey:["accounts",o]})}});return{isSavingAccount:u,isSavingAccountError:h,isSavingAccountSuccess:n,saveAccount:r}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Be(){const{isPending:e,mutateAsync:t}=X({mutationFn:async a=>L(a.url,a.data,void 0,"POST")});return{isVerifyAccountLoading:e,verifyAccount:a=>t(a)}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ve=e=>{switch(e){case"googleBusinessProfile":return l(ee,{children:[i("You can only add verified locations."),c("br",{}),i("If you need to add another Google account, simply log out of or switch Google accounts first.")]});default:return c(ee,{children:R(i("If you need to add another %s  account, simply log out of or switch %s accounts first."),e,e)})}};function Ee({count:e=0,platform:t}){return l(m.Text,{style:{fontSize:"14px"},type:"secondary",children:[l("div",{children:[R(i("Total %s accounts found"),e)," "]}),Ve(t)]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const De=({token:e})=>({background:`${e.colorBgLayout} `});function pe({accountType:e,connectAccountId:t,handleConnect:a,icon:o,id:s,isConnected:h,isLoading:u,name:n}){const r=JSON.parse(e).account_type;return c(J,{css:De,size:"small",children:l(Z,{align:"middle",justify:"space-between",children:[c(b,{children:l(k,{size:"small",children:[c(Me,{size:40,src:o}),l(D,{style:{maxWidth:"300px"},vertical:!0,children:[c(m.Text,{ellipsis:!0,strong:!0,title:n,children:n}),c(m.Text,{type:"secondary",children:r})]})]})}),c(b,{children:h?c(m.Text,{className:"mx-2",type:"success",children:i("Saved")}):c(w,{disabled:u&&s!==t,loading:u&&s===t,onClick:a,type:"primary",children:i("Save")})})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ge(){var E;const[e,t]=Fe($),{isProClient:a}=Q(se),{isSavingAccount:o,saveAccount:s}=$e(),{isVerifyAccountLoading:h,verifyAccount:u}=Be(),[n,r]=I.useState(),d=()=>{t(he)},g=I.useMemo(()=>Array.isArray(e==null?void 0:e.details)?e.details.map(p=>{const{details:y}=p.account,{account_id:T,account_name:j,icon:P}=JSON.parse(y);return{accountDetails:p.account,accountIcon:P,accountId:T,accountName:j,isConnected:p.isConnected,verifyUrl:p.verifyUrl}}):[],[e==null?void 0:e.details]),C=async(p,y)=>{var P;r(p.account_id);let T={...p};if(y){const A=await u({data:T,url:y});if(A.status==="error")return r(void 0),N.error({description:A.data.message,message:"Account Save Failed"});T=A.data.accountDetails}const j=await s(T);if(r(void 0),j.status==="error")return N.error({description:j.data.message,message:"Account Save Failed"});if(j.status==="success"){const U=(P=e==null?void 0:e.details)==null?void 0:P.map(A=>{const K=A.account.account_id;return String(K)===String(j.data.account.account_id)?{...A,isConnected:!0}:A});t(A=>({...A,details:U})),N.success({message:"Account Save Successfully"})}},S=e.platform&&ne[e.platform].name;return I.useEffect(()=>{function p(y){y.preventDefault(),t(he)}return window.addEventListener("beforeunload",p,{capture:!0}),()=>{window.removeEventListener("beforeunload",p,{capture:!0})}},[]),l(ie,{footer:!1,maskClosable:!1,onCancel:d,open:e.isModalOpen,styles:{body:{maxHeight:"70vh",overflowY:"scroll",padding:"0 8px"}},title:e.loading?l(k,{children:[c(O.Avatar,{active:!0,shape:"circle",size:"large"}),c(O.Input,{active:!0,size:"small"})]}):l(D,{align:"center",gap:"small",children:[c(ce,{name:e.platform,size:30}),c(m.Text,{style:{fontSize:"18px",textTransform:"capitalize"},children:S})]}),children:[l(k,{className:"w-100 py-2",direction:"vertical",children:[e.loading&&!e.status?Array.from({length:3}).fill(0).map((p,y)=>c(J,{className:"w-100",size:"small",children:l(k,{className:"w-100",size:"large",children:[c(O.Avatar,{active:!0,shape:"circle",size:"large"}),c(O.Input,{active:!0,block:!0,size:"small",style:{width:"260px"}}),c(O.Button,{active:!0})]})},`key-${y+9}`)):(S==="LinkedIn"&&!a?l(D,{gap:10,vertical:!0,children:[c(m.Title,{level:5,children:i("Profile")}),g&&g.length&&g.map(p=>c(pe,{accountType:p.accountDetails.details,connectAccountId:n,handleConnect:()=>C(p.accountDetails,p.verifyUrl),icon:p.accountIcon,id:p.accountId,isConnected:p.isConnected,isLoading:o||h,name:p.accountName},p.accountId)),l(m.Title,{level:5,children:[i("Page")," ",c(ve,{color:"#ff8609",size:20})]}),c(J,{className:"w-100",size:"small",children:l(k,{className:"w-100",size:"large",children:[c(O.Avatar,{shape:"circle",size:"large"}),c(O.Input,{block:!0,size:"small",style:{width:"260px"}}),c(O.Button,{})]})}),c(m.Text,{strong:!0,children:i("Linkedin Page feature on pro")})]}):g&&g.length&&g.map(p=>c(pe,{accountType:p.accountDetails.details,connectAccountId:n,handleConnect:()=>C(p.accountDetails,p.verifyUrl),icon:p.accountIcon,id:p.accountId,isConnected:p.isConnected,isLoading:o||h,name:p.accountName},p.accountId)))||"",e.status==="success"&&!((E=e.details)!=null&&E.length)&&c(m.Title,{level:5,children:S==="Pinterest"?i("Board Not Found"):i("Account Not Found")}),e.status==="error"&&l(D,{vertical:!0,children:[l(m.Title,{level:5,children:[" ",i("Account connect failed")]}),c(_e,{description:e.message,type:"error"})]})]}),e.status&&S?c(Ee,{count:g==null?void 0:g.length,platform:S}):c(m.Title,{level:5,children:"Fetching data, please wait..."})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Ke(){const{data:e,isFetching:t,isLoading:a,refetch:o}=W({queryFn:async()=>L("platforms-credentials",void 0,void 0,"POST"),queryKey:["clientIds"]}),{clientInfo:s}=(e==null?void 0:e.data)||{};return{clientIds:s,isFetchingClientIds:t,isLoadingClientIds:a,refetchClientIds:o}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ge={bluesky:"https://bit-social.com/documentation/accounts/connect-your-bluesky-account-with-bit-social/",discord:"https://bit-social.com/docs/accounts/connect-your-discord-account-with-bit-social/",facebook:"https://bit-social.com/documentation/accounts/connect-your-facebook-account-with-bit-social/",googleBusinessProfile:"https://bit-social.com/documentation/accounts/connect-your-google-business-profile-account-with-bit-social/",instagram:"https://bit-social.com/documentation/accounts/connect-your-instagram-account-with-bit-social/",line:"https://bit-social.com/documentation/accounts/connect-your-line-account-with-bit-social/",linkedin:"https://bit-social.com/documentation/accounts/connect-your-linkedin-account-with-bit-social/",pinterest:"https://bit-social.com/docs/accounts/connect-your-pinterest-account-with-bit-social/",tiktok:"https://bit-social.com/documentation/accounts/connect-your-tiktok-account-with-bit-social/",tumblr:"https://bit-social.com/documentation/accounts/connect-your-tumblr-account-with-bit-social/",twitter:"https://bit-social.com/documentation/accounts/connect-your-twitter-account-with-bit-social/"};function He(e){if(!e||!ge[e]){console.error("Invalid link key",e);return}const t=new URL(ge[e]);return t.searchParams.append("utm_source",G.PLUGIN_SLUG),t.searchParams.append("utm_medium","inside-plugin"),t.href}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function me({platform:e}){return c(w,{href:He(e),icon:c(Ne,{}),rel:"noopener noreferrer nofollow",size:"small",style:{whiteSpace:"nowrap"},target:"_blank",type:"link",children:i("Doc Link")})}const Ye="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='512'%20width='512'%20xmlns:v='https://vecta.io/nano'%3e%3cpath%20d='M501.301%20131.964c-5.888-22.172-23.237-39.633-45.266-45.56C416.107%2075.636%20256%2075.636%20256%2075.636s-160.107%200-200.035%2010.768c-22.029%205.926-39.378%2023.388-45.266%2045.56C0%20172.152%200%20256%200%20256s0%2083.848%2010.699%20124.036c5.888%2022.172%2023.237%2039.633%2045.266%2045.56C95.893%20436.364%20256%20436.364%20256%20436.364s160.107%200%20200.035-10.768c22.029-5.927%2039.378-23.388%2045.266-45.56C512%20339.848%20512%20256%20512%20256s0-83.848-10.699-124.036z'%20fill='red'/%3e%3cpath%20d='m203.636%20332.128%20133.818-76.126-133.818-76.13z'%20fill='%23fff'/%3e%3c/svg%3e";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:Qe}=m,fe={bluesky:"https://www.youtube.com/watch?v=2ftNPVnAISI",discord:"https://www.youtube.com/watch?v=q85NrjFQ33Y",facebook:"https://www.youtube.com/watch?v=V7-DqQ4dJg4",googleBusinessProfile:"https://www.youtube.com/watch?v=o3Hf2v4HsVs",linkedin:"https://www.youtube.com/watch?v=YcmVEq3GGsk",pinterest:"https://www.youtube.com/watch?v=6deQqqhMYLY",tiktok:"https://www.youtube.com/watch?v=5w5c0kY2tno",tumblr:"https://www.youtube.com/watch?v=WfxpNBBAjRQ",twitter:"https://www.youtube.com/watch?v=v2m99Itn-KU"};function Ce({platform:e}){if(!(!e||!fe[e]))return c(Qe,{href:fe[e],rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:c(w,{icon:c(Me,{alt:"youtube",size:20,src:Ye}),size:"small",type:"text",children:i("Tutorial")})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:Je}=m;function z({devLink:e,name:t}){return l(ee,{children:[i("To get app credentials, Visit")," ",l(Je,{href:e,rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:[ne[t].name," ",i("Developer"),c(te,{size:12,style:{transform:"translateY(-2px)"}})]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:We}=m,Xe=e=>{switch(e){case"discord":return c(z,{devLink:"https://discord.com/developers/applications/",name:e});case"facebook":return c(z,{devLink:"https://developers.facebook.com/apps/",name:e});case"googleBusinessProfile":return c(z,{devLink:"https://console.cloud.google.com/",name:e});case"instagram":return c(z,{devLink:"https://developers.facebook.com/apps/",name:e});case"linkedin":return c(z,{devLink:"https://www.linkedin.com/developers/apps",name:e});case"pinterest":return c(z,{devLink:"https://developers.pinterest.com/apps/",name:e});case"tiktok":return c(z,{devLink:"https://developers.tiktok.com",name:e});case"tumblr":return c(z,{devLink:"https://www.tumblr.com/oauth/apps",name:e});case"twitter":return c(z,{devLink:"https://developer.twitter.com/en/portal/dashboard",name:e});default:return""}};function Ze({platform:e}){return c(We,{children:Xe(e)})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function et(){const e=ae(),{isPending:t,mutateAsync:a}=X({mutationFn:async o=>L("custom-app",{...o},void 0,"POST"),mutationKey:["custom_app"],onSuccess:()=>{e.invalidateQueries({queryKey:["get-customApp"]})}});return{createCustomApp:o=>a(o),isLoadingCreateCustomApp:t}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function tt(e){const{data:t,isLoading:a,refetch:o}=W({queryFn:async()=>L("custom-app",void 0,{platform:e},"GET"),queryKey:["get-customApp"],refetchOnWindowFocus:!1});return{customApps:t==null?void 0:t.data,isLoadingCustomApp:a,refetchCustomApp:o}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function ct(){const e=ae(),{isPending:t,mutateAsync:a}=X({mutationFn:async o=>L(`custom-app/${o}/destroy`,void 0,void 0,"POST"),onSuccess:()=>{e.invalidateQueries({queryKey:["get-customApp"]})}});return{deleteCustomApp:o=>a(o),isLoadingDeleteCustomApp:t}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const xe=(e,t,a,o,s,h,u)=>{const[n,r]=[700,700],d=Math.round((window.innerWidth-n)/2),g=Math.round((window.innerHeight-r)/2),C=window.open(e,t,`width=${n},height=${r},left=${d},top=${g},toolbar=off`),S=setInterval(()=>{localStorage.setItem("__bitSocial_platform_interval",String(S)),!(!(C!=null&&C.closed)||C!=null&&C.closed&&!localStorage.getItem("__bitSocial_platform"))&&(clearInterval(S),a==null||a(),u(o,s,h))},500)};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const ot=`${G.CLIENT_SECRET_URL}`,{baseAuthStateURL:at}=_(x),st=async e=>{const t={client_id:e.appId,platform:"facebook"},a={body:JSON.stringify(t),headers:{"Content-Type":"application/json"},method:"POST"};return fetch(ot,a).then(o=>o.json())},it=async(e,t,a)=>{const o={...e};if(a==="oneClickAuth"){const n=await st(o);o.appSecret=n.clientSecret}const s={config:{authType:"OAuth2",platform:o.platform},payload:{client_id:o.appId,client_secret:o.appSecret,code:t.code,grant_type:"no need",redirect_uri:o.redirectUri}},{data:h,status:u}=await L("authorize",s,void 0,"POST");u==="success"&&Y($,{details:h,isModalOpen:!0,loading:!1,platform:"facebook",status:u})},nt=async(e,t,a)=>{let o={};const s=localStorage.getItem("__bitSocial_platform");s&&(o=JSON.parse(s),localStorage.removeItem("__bitSocial_platform")),(!o||!o.code||o.error)&&N.error({description:`${o.error?`Cause: ${o.error}.`:""} Please try again`,message:"Authorization failed"});const h=await it(e,o,a);return t(),h},rt=(e,t,a,o)=>{if(!e.platform||!e.appId||!e.redirectUri)throw new Error("Missing credentials");const{appId:s,platform:h,redirectUri:u}=e,n=o==="oneClickAuth"?G.REDIRECT_URL:u,r="pages_show_list,pages_read_engagement,pages_manage_metadata,pages_manage_posts,business_management",d=new URL("https://www.facebook.com/dialog/oauth");d.searchParams.append("scope",r),d.searchParams.append("client_id",s),d.searchParams.append("redirect_uri",n),d.searchParams.append("state",at+"#/accounts/auth/response"),xe(d,h,a,e,t,o,nt)};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const lt=`${G.CLIENT_SECRET_URL}`,Ie=`${G.REDIRECT_URL}`,{baseAuthStateURL:ht}=_(x),ut=async(e,t)=>{const a={config:{authType:"OAuth2",platform:e.platform},payload:{client_id:e.appId,client_secret:e.appSecret,code:t.code,grant_type:"null",redirect_uri:e.redirectUri}},{data:o,status:s}=await L("authorize",a,void 0,"POST");s==="success"&&Y($,{...{isModalOpen:!0,loading:!1,platform:"linkedin",status:s},details:o})},dt=async e=>{const t={client_id:e.appId,platform:e.platform},a={body:JSON.stringify(t),headers:{"Content-Type":"application/json"},method:"POST"};return fetch(lt,a).then(o=>o.json())},pt=async(e,t,a)=>{let o={};const s=localStorage.getItem("__bitSocial_platform"),h={...e};if(s&&(o=JSON.parse(s),localStorage.removeItem("__bitSocial_platform")),!o.code){N.error({description:`${o.error?`Cause: ${o.error}.`:""} Please try again`,message:"Authorization failed"});return}if(a==="oneClickAuth"){const n=await dt(e);(!n||!n.clientSecret)&&N.error({description:`Cause: ${n.message}. Please try again`,message:"Authorization failed"}),h.appSecret=n.clientSecret.toString(),h.redirectUri=Ie}const u=await ut(h,o);return t(),u},gt=(e,t,a,o)=>{if(!e.platform||!e.appId||!e.redirectUri)throw new Error("Missing credentials");const{appId:s,platform:h,redirectUri:u}=e,n=o==="oneClickAuth"?Ie:u,r="openid profile email w_member_social r_organization_admin w_organization_social rw_organization_admin",d=new URL("https://www.linkedin.com/oauth/v2/authorization");d.searchParams.append("scope",r),d.searchParams.append("client_id",s),d.searchParams.append("response_type","code"),d.searchParams.append("redirect_uri",n),d.searchParams.append("state",ht+"#/accounts/auth/response"),xe(d,h,a,e,t,o,pt)};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function mt(e){switch(e){case"facebook":return rt;case"linkedin":return gt}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};_(x);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Pe({authType:e="oneClickAuth",clientId:t,closeConnectModal:a,handleAuthCallback:o,isConnectLoading:s,platform:h,platformCredentialData:u,setCustomModalOpen:n}){const r=ke(Se),d=mt;return c(w,{block:!0,disabled:!t,loading:s,onClick:()=>{const C=d(h,u.apiVersion);if(oe(h)){r(!0);return}n&&n(!1),C&&C(u,o,a,e)},size:"small",type:"primary",children:i("Connect")})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:ft}=m;var Ct={name:"3s4yqf",styles:"width:400px"};function yt({closeConnectModal:e,credential:t,handleAuthCallback:a,handleDelete:o,isDeleteLoading:s,name:h,platform:u,setCustomModalOpen:n}){const r={apiVersion:t.apiVersion??void 0,appId:t.appKey,appSecret:t.appSecret,platform:u,redirectUri:t.redirectUri};return c(J,{css:Ct,size:"small",children:l(Z,{align:"middle",justify:"space-between",children:[c(ft,{className:"text-capitalize",ellipsis:!0,strong:!0,style:{width:"200px"},children:h}),l(k,{children:[c(Pe,{authType:"customAuth",clientId:t.appKey,closeConnectModal:e,handleAuthCallback:a,platform:u,platformCredentialData:r,setCustomModalOpen:n}),c(Oe,{cancelText:i("No"),description:i("Are you sure to delete this app?"),okButtonProps:{danger:!0,loading:s},okText:i("Yes, Delete"),onConfirm:o,placement:"bottomRight",title:i("Delete the app"),children:c(w,{danger:!0,icon:c(Ue,{}),type:"text"})})]})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:V,Title:bt}=m,ye=(e,t)=>({apiVersion:["twitter"],appName:["twitter","tumblr"]})[t].includes(e);var wt={name:"11vupei",styles:"border-right:1px solid #B9B9B9"};function At({closeConnectModal:e,handleAuthCallback:t,platform:a,setCustomModalOpen:o}){var q,re,le;const{apiURL:s,siteUrl:h}=Q(x),u=`${s.base}/redirect`,n=h,[r]=f.useForm(),[d,g]=I.useState({}),{createCustomApp:C,isLoadingCreateCustomApp:S}=et(),{deleteCustomApp:E,isLoadingDeleteCustomApp:p}=ct(),{customApps:y}=tt(a),T=I.useRef(null),j=v=>{try{navigator.clipboard.writeText(v),N.success({message:"Copied!"})}catch{T.current!=null&&(T.current.select(),document.execCommand("copy"),T.current.blur())}},P=v=>{r.setFieldsValue({apiVersion:v})},U=[{label:"v1.1 (media supported)",value:"1.1"},{label:"v2.0 (media unsupported)",value:"2"}],A=async v=>{const ze={...v,platform:a},B=await C(ze);(B==null?void 0:B.code)==="SUCCESS"?(r.resetFields(),N.success({description:B.data.message,message:"App successfully added!"})):(B.data.errorField&&g(B.data.errorField),N.error({description:B.data.message,message:"App add failed"}))},K=v=>{E(v)};return l(Z,{className:"mt-4",gutter:[48,0],justify:"center",children:[c(b,{css:wt,span:12,children:l(f,{form:r,initialValues:{redirectUri:u},layout:"vertical",onFinish:A,children:[c(f.Item,{label:c(V,{strong:!0,children:i("Homepage URI")}),name:"homepageUri",rules:[{message:"Please enter homepage url"}],children:l(k.Compact,{className:"w-100",children:[c(F,{defaultValue:`${n}`,ref:T,style:{width:"calc(100% - 32px)"}}),c(w,{icon:c(ue,{size:12}),onClick:()=>j(n),title:i("Click to copy")})]})}),c(f.Item,{label:c(V,{strong:!0,children:i("Redirect URI")}),name:"redirectUri",rules:[{message:"Please enter redirect url",required:!0}],children:l(k.Compact,{className:"w-100",children:[c(F,{defaultValue:`${u}`,ref:T,style:{width:"calc(100% - 32px)"}}),c(w,{icon:c(ue,{size:12}),onClick:()=>j(u),title:i("Click to copy")})]})}),ye(a,"apiVersion")?c(f.Item,{label:c(V,{strong:!0,children:i("Api Version")}),name:"apiVersion",rules:[{message:"Please select an API version",required:!0}],children:c(Le,{onChange:P,options:U})}):"",ye(a,"appName")?l(f.Item,{label:c(V,{strong:!0,children:i("App Name")}),name:"appName",rules:[{message:"Please enter your app name",required:!0}],children:[c(F,{}),d.appName&&c(m.Text,{type:"danger",children:(q=d.appName)==null?void 0:q[0]})]}):"",c(k,{className:"pb-2",children:c(Ze,{platform:a})}),l(f.Item,{label:c(V,{strong:!0,children:i("App Key or Client ID")}),name:"appKey",rules:[{message:"Please enter your app key",required:!0}],children:[c(F,{}),d.appKey&&c(m.Text,{type:"danger",children:(re=d.appKey)==null?void 0:re[0]})]}),l(f.Item,{label:c(V,{strong:!0,children:i("App Secret or Client Secret")}),name:"appSecret",rules:[{message:"Please enter your app secret",required:!0}],children:[c(F,{}),d.appSecret&&c(m.Text,{type:"danger",children:(le=d.appSecret)==null?void 0:le[0]})]}),c(f.Item,{children:c(w,{className:"w-100",loading:S,onClick:()=>{r.submit()},size:"large",type:"primary",children:i("Add")})})]},a)}),l(b,{span:12,children:[c(bt,{level:5,children:i("Connected Apps")}),c(k,{direction:"vertical",children:y&&y.length?y.map(v=>c(yt,{appId:v.id,closeConnectModal:e,credential:v.credential,handleAuthCallback:t,handleDelete:()=>K(v.id),isDeleteLoading:p,name:v.name,platform:a,setCustomModalOpen:o},v.id)):c(V,{children:i("No App Found")})})]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Tt=async(e,t,a)=>{const{id:o,token:s,type:h}=e;Y($,{isModalOpen:!0,loading:!0}),t(),a();const n={config:{authType:"Token",platform:"line"},payload:{id:o,token:s,type:h}},{data:r,status:d}=await L("authorize",n,void 0,"POST"),g={isModalOpen:!0,loading:!1,platform:"line",status:d};d==="success"&&Y($,{...g,details:r}),d==="error"&&"message"in r&&typeof r.message=="string"&&Y($,{...g,message:r.message})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Link:be,Text:H}=m;function vt({closeConnectModal:e,handleAuthCallback:t,platform:a}){const[o]=f.useForm(),[s,h]=I.useState("group"),u=async n=>{Tt(n,t,e)};return I.useEffect(()=>{o.setFieldsValue({type:s})},[s,o]),l(f,{form:o,initialValues:{type:"group"},layout:"vertical",onFinish:u,children:[c(f.Item,{label:c(H,{strong:!0,children:i("Type")}),name:"type",children:c(Le,{onChange:n=>h(n),options:[{label:i("Group"),value:"group"},{label:i("User"),value:"user"}]})}),c(f.Item,{extra:l(H,{type:"secondary",children:[R(i("Enter the ID of the target recipient. Use a %s Id value returned in a"),s)," ",l(be,{href:"https://developers.line.biz/en/reference/messaging-api/#common-properties",rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:[i("webhook event object"),c(te,{size:12,style:{transform:"translateY(-2px)"}})]})]}),htmlFor:"id",label:c(H,{className:"capitalize",strong:!0,children:R(i("%s Id"),s)}),name:"id",rules:[{message:R("Please enter your %s id",s),required:!0}],children:c(F,{id:"id",name:"id"})}),c(f.Item,{extra:l(H,{type:"secondary",children:[i("To get token, Visit "),l(be,{href:"https://developers.line.biz/console/",rel:"noopener noreferrer nofollow",strong:!0,style:{whiteSpace:"nowrap"},target:"_blank",children:[i("developer console"),c(te,{size:12,style:{transform:"translateY(-2px)"}})]})]}),htmlFor:"token",label:c(H,{strong:!0,children:i("Token")}),name:"token",rules:[{message:"Please enter your channel access token",required:!0}],children:c(F,{id:"token",name:"token"})}),c(f.Item,{children:c(w,{className:"w-100 capitalize",onClick:()=>o.submit(),size:"large",type:"primary",children:R(i("Connect %s"),a)})})]},a)}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function kt({platform:e}){switch(e){case"bluesky":return c(_e,{message:"If 2FA is enable, you must use an App Password in the password field instead of your regular password.",showIcon:!0,type:"info"});default:return""}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const{Text:we}=m;function St({closeConnectModal:e,handleAuthCallback:t,platform:a}){const[o]=f.useForm();return l(f,{form:o,layout:"vertical",onFinish:async h=>{},children:[c(f.Item,{label:c(we,{strong:!0,children:i("Username or Email")}),name:"id",rules:[{message:"Please enter your username or email",required:!0}],children:c(F,{})}),c(f.Item,{label:c(we,{strong:!0,children:i("Password")}),name:"password",rules:[{message:"Please enter your password",required:!0}],children:c(F,{})}),c(f.Item,{children:c(kt,{platform:a})}),c(f.Item,{children:c(w,{className:"w-100",onClick:()=>{o.submit()},size:"large",type:"primary",children:R(i("Connect %s "),a)})})]},a)}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function jt({closeConnectModal:e,currentConnectType:t,handleAuthCallback:a,platform:o,setCustomModalOpen:s}){switch(t){case"custom":return c(At,{closeConnectModal:e,handleAuthCallback:a,platform:o,setCustomModalOpen:s});case"login":switch(o){case"bluesky":return c(St,{closeConnectModal:e,handleAuthCallback:a,platform:o});case"line":return c(vt,{closeConnectModal:e,handleAuthCallback:a,platform:o})}}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Mt=`${G.REDIRECT_URL}`,{Title:Ae}=m,_t={custom:i("Connect Custom %s App"),login:i("%s"),oneClick:i("Connect %s")};function M({clientId:e,closeConnectModal:t,isConnectLoading:a,name:o,platform:s,setAccountModal:h,types:u}){const{refetchAccounts:n}=Re(),[r,d]=Te({}),g=r.get("value")||"all",[C,S]=I.useState(),[E,p]=I.useState(!1),{token:y}=je.useToken(),T=ke(Se),{isProClient:j}=Q(se),P=()=>{p(!1)},U=q=>{if(S(q),oe(s)&&!j){T(!0);return}t(),p(!0)},A=()=>{d(q=>(q.set("type","platform"),q.set("value",String(g)),q)),n()},K=()=>{P(),h(!0)};return c(J,{style:{borderColor:y.colorBorder,height:"100%"},children:l(D,{gap:14,vertical:!0,children:[l(k,{align:"center",children:[c(ce,{name:s,size:30,style:{flexShrink:0}}),c(Ae,{className:"text-capitalize",level:5,style:{marginBottom:0},children:o||ne[s].name}),oe(s)&&!j&&c(ve,{color:"#ff8609",size:20})]}),l(k,{size:0,children:[c(me,{platform:s}),c(Ce,{platform:s})]}),l(k,{direction:"vertical",size:"small",children:[u.includes("custom")&&c(w,{block:!0,onClick:()=>U("custom"),size:"small",style:{borderColor:y.colorPrimary},children:i("Custom App")}),u.includes("login")&&c(w,{block:!0,onClick:()=>U("login"),size:"small",type:"primary",children:i("Login")}),u.includes("oneClick")&&e&&c(Pe,{clientId:e,closeConnectModal:t,handleAuthCallback:A,isConnectLoading:a,platform:s,platformCredentialData:{appId:e,appSecret:"",platform:s,redirectUri:Mt}})]}),C&&c(ie,{centered:!0,footer:!1,onCancel:()=>p(!1),onOk:P,open:E,title:c("div",{children:l(D,{align:"center",gap:10,children:[c(w,{icon:c(qe,{size:24}),onClick:K,title:i("Back"),type:"text"}),c(ce,{name:s,size:34}),c(Ae,{className:"text-capitalize",level:5,style:{marginBottom:0},children:R(i(_t[C]),s)}),c(me,{platform:s}),c(Ce,{platform:s})]})}),width:900,children:c(jt,{closeConnectModal:t,currentConnectType:C,handleAuthCallback:A,platform:s,setCustomModalOpen:p})},s)]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function Rt({btnType:e="default"}){const{clientIds:t,isLoadingClientIds:a}=Ke(),{token:o}=je.useToken(),{isDarkTheme:s}=Q(se),{isModalOpen:h}=Q($),[u,n]=I.useState(!1),r=()=>{const g=localStorage.getItem("__bitSocial_platform_interval");g&&(clearInterval(Number(g)),localStorage.removeItem("__bitSocial_platform_interval")),n(!1)},d=()=>{n(!0)};return l("div",{children:[e==="default"?c(w,{icon:c(de,{size:18}),onClick:d,size:"small",type:"primary",children:i("Connect Account")}):c(w,{"aria-label":i("Connect Account"),icon:c(de,{size:30}),onClick:d,style:{alignItems:"center",border:`2px solid ${o.colorPrimary}`,color:s?o.colorTextBase:o.colorPrimary,display:"flex",fontSize:"17px",fontWeight:600,height:"100%",justifyContent:"center",minHeight:"110px",width:"100%"},type:"text",children:i("Connect Account")}),c(ie,{centered:!0,footer:!1,onCancel:r,open:u,style:{padding:"20px"},title:i("Connect Account"),width:1e3,children:l(Z,{className:"p-2",gutter:[12,12],children:[c(b,{md:6,sm:12,xs:24,children:c(M,{clientId:t==null?void 0:t.facebook.id,closeConnectModal:r,isConnectLoading:a,platform:"facebook",setAccountModal:n,status:t==null?void 0:t.facebook.status,types:["oneClick","custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{clientId:t==null?void 0:t.linkedin.id,closeConnectModal:r,isConnectLoading:a,platform:"linkedin",setAccountModal:n,status:t==null?void 0:t.linkedin.status,types:["oneClick","custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{clientId:t==null?void 0:t.googleBusinessProfile.id,closeConnectModal:r,isConnectLoading:a,name:"Google Business",platform:"googleBusinessProfile",setAccountModal:n,status:t==null?void 0:t.googleBusinessProfile.status,types:["oneClick","custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{clientId:t==null?void 0:t.pinterest.id,closeConnectModal:r,isConnectLoading:a,platform:"pinterest",setAccountModal:n,status:t==null?void 0:t.pinterest.status,types:["oneClick","custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{clientId:t==null?void 0:t.discord.id,closeConnectModal:r,isConnectLoading:a,platform:"discord",setAccountModal:n,status:t==null?void 0:t.discord.status,types:["oneClick","custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{clientId:t==null?void 0:t.tumblr.id,closeConnectModal:r,isConnectLoading:a,platform:"tumblr",setAccountModal:n,status:t==null?void 0:t.tumblr.status,types:["oneClick","custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{clientId:t==null?void 0:t.instagram.id,closeConnectModal:r,isConnectLoading:a,platform:"instagram",setAccountModal:n,status:t==null?void 0:t.instagram.status,types:["oneClick","custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{closeConnectModal:r,name:"TikTok",platform:"tiktok",setAccountModal:n,types:["custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{closeConnectModal:r,name:"X (Twitter)",platform:"twitter",setAccountModal:n,types:["custom"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{closeConnectModal:r,name:"Bluesky",platform:"bluesky",setAccountModal:n,status:0,types:["login"]})}),c(b,{md:6,sm:12,xs:24,children:c(M,{closeConnectModal:r,name:"Line",platform:"line",setAccountModal:n,status:0,types:["login"]})})]})}),h&&c(Ge,{})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};function $t(){const{data:e,isLoading:t,refetch:a}=W({queryFn:async()=>L("pro_groups",void 0,void 0,"GET"),queryKey:["groups"]});return{groups:(e==null?void 0:e.data)||[],isLoadingGroups:t,refetchGroups:a}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Bt=e=>e.accounts.map(a=>Number(a.id)),Vt=(e,t,a)=>{const o=t.find(s=>s.name.toLowerCase()===e.toLowerCase());return!!o&&o.id!==a};export{Rt as C,$t as a,Bt as g,Vt as i,Re as u};
