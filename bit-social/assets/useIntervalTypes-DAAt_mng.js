import{a as f,j as n,r as L,F as K,c as V,u as G,d as O,b as P,L as H}from"./main-afraid-ants-sort.js";import{P as w,p as I}from"./PlatformIcon-DHlKQsTj.js";import{S as Q,T as y,F as $,A as R,j as W,r as i,Q as D,u as Y}from"./antd-CMhliQbc.js";import{u as J}from"./react-query-BAnB2mAm.js";import{b as U,a as X}from"./groupHelper-PveggK-o.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function pe({iconSize:t=50,textLevel:e=3}){return f($,{align:"center",className:"py-3",gap:20,justify:"center",style:{height:"140px"},vertical:!0,children:[f(Q,{children:[n(w,{name:"facebook",size:t}),n(w,{name:"twitter",size:t}),n(w,{name:"pinterest",size:t}),n(w,{name:"googleBusinessProfile",size:t})]}),n(y.Title,{level:e,children:"Connect your social account first!"})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function N(){const{data:t,isLoading:e,refetch:a}=J({queryFn:async()=>L("active-accounts",void 0,void 0,"GET"),queryKey:["active-accounts"]});return{activeAccounts:(t==null?void 0:t.data)||[],isLoadingActiveAccounts:e,refetchActiveAccounts:a}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const{Text:Z}=y;function B({img:t,name:e}){return n(W,{justify:"space-between",children:f($,{align:"center",gap:6,justify:"center",children:[n(R,{shape:"square",src:t}),n(Z,{ellipsis:!0,title:e,children:e})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const F=(t,e,a,c,r)=>a?c.filter(u=>u.platform===a&&u.details.account_name.toLowerCase().includes(t)):e==="groups"?r:c.filter(u=>u.platform===a),q=t=>[...new Set(t.map(e=>e.platform))],S=(t,e)=>{const a=t?t.map(r=>`account-${r}`):[],c=e?e.map(r=>`group-${r}`):[];return[...a,...c]},ee=(t,e,a)=>e.filter(c=>t.includes(c.id)).map(c=>({checkable:!1,key:`account-${a}-${c.id}`,title:n(B,{img:c.details.icon,name:c.details.account_name})})),te=(t,e,a,c)=>{let r=[];const o=[{children:q(a).map(s=>{var d,m;return r.push(s),{children:F(t,e,s,a,c).map(h=>{const g=`account-${h.id}`;return{disabled:e!=="all"&&e!==s,key:g,style:e!=="all"&&e!==s?{display:" none"}:{},title:"details"in h&&n(B,{img:h.details.icon,name:h.details.account_name})}}),key:s,style:e!==s&&e!=="all"?{display:" none"}:{},title:n(y.Text,{ellipsis:!0,title:(d=I[s])==null?void 0:d.name,children:(m=I[s])==null?void 0:m.name})}}),key:"all",title:"Select All"}];return e==="all"&&r.push(e,"groups"),e!=="all"&&e!=="groups"&&(r=["all",e]),{accountExpandKeys:r,accountTreeData:o}},ae=(t,e,a,c)=>{const r=[],u=[{children:F(t,"groups","",a,c).map(o=>{const s=`group-${o.id}`,d="accounts"in o?U(o):[];return d.length&&r.push(s),{children:ee(d,a,s),key:s,style:{overflow:"hidden"},title:"name"in o&&n(y.Text,{ellipsis:!0,title:o.name,children:o.name})}}),key:"groups",style:e==="all"||e==="groups"?{}:{display:" none"},title:"Groups"}];return{groupExpandKeys:r,groupTreeData:u}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};var se={name:"16bnd5q",styles:"min-height:100%;overflow:hidden"};function ce({accountType:t,isLoading:e,selectedAccount:a,setSelectedAccount:c}){const[r,u]=i.useState(),[o,s]=i.useState(a),{groups:d}=X(),{activeAccounts:m}=N(),h=d.map(p=>{const j=p.accounts.map(b=>Number(b.id));return{...p,accountIds:j}}),g=i.useMemo(()=>S(o==null?void 0:o.accountIds,o==null?void 0:o.groupIds),[o]),{groupExpandKeys:T,groupTreeData:v}=i.useMemo(()=>ae("",t,m,h),[t,m,d]),x=p=>{const k=Array.isArray(p)?p:p.checked,b=[...new Set(h.filter(l=>k.includes(`group-${l.id}`)).map(l=>Number(l.id)))];s(l=>{const E={...l,groupIds:b};return c(E),E})},C=p=>{u(p)};return i.useEffect(()=>{s(a)},[a]),i.useEffect(()=>{u(T)},[T]),n("div",{css:se,children:["all","groups"].includes(t)&&f(K,{children:[n(y.Title,{className:"bg-slate-200 p-2 dark:bg-slate-800",level:4,children:"Groups"}),n(D,{autoExpandParent:!0,blockNode:!0,checkable:!0,checkedKeys:g,className:"pr-3",defaultExpandAll:!0,disabled:e,expandedKeys:r,onCheck:x,onExpand:C,selectable:!1,treeData:v},v.length)]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};var ne={name:"16bnd5q",styles:"min-height:100%;overflow:hidden"},oe={name:"1xjypij",styles:"margin:4px 0;width:100%"};function ge({isLoading:t,selectedAccount:e,setSelectedAccount:a}){const[c,r]=i.useState("all"),[u,o]=i.useState(),[s,d]=i.useState(e),m=V(O),{isProClient:h}=G(P),{activeAccounts:g}=N(),T=i.useMemo(()=>S(s==null?void 0:s.accountIds,s==null?void 0:s.groupIds),[s]),v=i.useMemo(()=>q(g).map(l=>({label:I[l].name,value:l})),[g]),{accountExpandKeys:x,accountTreeData:C}=i.useMemo(()=>te("",c,g,[]),[c,g]),p=[{label:"All",value:"all"},{disabled:!h,label:h?"Groups":f(K,{children:["Groups ",n(H,{color:"#ff8609",name:"crown",size:18})]}),value:"groups"},...v],k=l=>{if(!h&&l==="groups"){m(!0);return}r(l)},j=l=>{const E=Array.isArray(l)?l:l.checked,_=g.filter(A=>E.includes(`account-${A.id}`)).map(A=>A.id),z=[...new Set(_)];d(A=>{const M={...A,accountIds:z};return a(M),M})},b=l=>{o(l)};return i.useEffect(()=>{d(e)},[e]),i.useEffect(()=>{o(x)},[x]),f("div",{css:ne,children:[n(Y,{css:oe,defaultValue:c,onChange:k,options:p}),c!=="groups"&&f(K,{children:[n(y.Title,{className:"bg-slate-200 p-2 dark:bg-slate-800",level:4,children:"Accounts"}),n(D,{autoExpandParent:!0,blockNode:!0,checkable:!0,checkedKeys:T,className:"pr-3",defaultExpandAll:!0,disabled:t,expandedKeys:u,onCheck:j,onExpand:b,selectable:!1,treeData:C},C.length)]}),h&&n(ce,{accountType:c,isLoading:t,selectedAccount:e,setSelectedAccount:a})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function me(){const{isProClient:t}=G(P),e=[{label:"Minute",value:"minute"},{label:"Hour",value:"hour"}],a=[{label:"Minute",value:"minute"},{label:"Hour",value:"hour"},{label:"Day",value:"day"},{label:"Week",value:"week"},{label:"Month",value:"month"},{label:"Year",value:"year"}];return t?a:e}export{pe as A,ge as F,N as a,me as u};
