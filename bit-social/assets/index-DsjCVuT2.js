import{q as le,v as de,w as he,A as ue,r as E,G as me,W as pe,R as ge,U as Se,a8 as R,z as i,j as s,T as P,y as l,B as S,L as f,S as k,a4 as z,F as M,X as B,a5 as b,I as fe}from"./main-true-brooms-decide.js";import{u as Te,t as xe,$ as ye,a as _e}from"./DatePicker-D7wcs48p.js";import{u as be}from"./useDebounce-Cs6jNnSN.js";import{C as Ce}from"./CronWarning-BBcLiDTI.js";import{u as Ae,N as ve}from"./useUpdateScheduleStatus-CT0lxm8S.js";import{u as Ie,C as O}from"./CreateScheduleModal-Cy5NTF4p.js";import{D as Ee,R as Pe,F as ke}from"./Refresh-R_xeaRuH.js";import{d as C}from"./index-BwECeg_0.js";import{s as Me}from"./index-BilOIdWx.js";import{T as U}from"./index-CINFlSGs.js";import{S as we,I as De,E as Ne}from"./index-CgzT355L.js";import{P as W}from"./index-CrXlKC-2.js";import{F as je}from"./index-C0SXAKV0.js";import"./useSocialTemplates-BPe86rH6.js";import"./PlatformIcon-B7HCNuDB.js";import"./index-dPBRjyG0.js";import"./row-BYvNj_lK.js";import"./index-DIRne3gr.js";import"./useIntervalTypes-BNx2f9Nc.js";import"./groupHelper-k93c-VM6.js";import"./index-BaBQFs85.js";import"./EllipsisOutlined-CSCHq2sX.js";import"./Dropdown-B3VPyAjl.js";import"./index-D-3y6LNR.js";import"./index-D7jaFu40.js";import"./index-BtnYMF7o.js";import"./collapse-BbEVqHco.js";import"./index-nNmyUtHs.js";import"./index-CHaNjuBo.js";import"./index--FLOYmlC.js";import"./EyeOutlined-CWz1vL0K.js";import"./addEventListener-B3mmm8kF.js";import"./LeftOutlined-Co4hm0M-.js";import"./emotion-react.browser.esm-BUYz_XM1.js";import"./usePostTypes-C8zEJFZG.js";import"./index-DboAGfd9.js";import"./context-IZbCqyHP.js";import"./index-CX4jwO2a.js";import"./index-qL69fBb3.js";import"./move-DHiUc4J8.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};function $e(){const a=le(),{isPending:n,isSuccess:m,mutateAsync:T}=de({mutationFn:async d=>{if(!d.length)throw new Error("Schedule ID is undefined");return he("schedule/destroy",{scheduleIds:d},void 0,"POST")},onSuccess:()=>{a.invalidateQueries({queryKey:["get-calendar-schedules"]}),a.invalidateQueries({queryKey:["all-schedules"]})}});return{deleteSchedule:d=>T(d),deleteScheduleLoading:n,deleteScheduleSuccess:m}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};C.extend(Te);C.extend(xe);const Fe=({token:a})=>({background:a.colorSuccessBg,border:`1px solid ${a.colorSuccessBorder}`,borderRadius:"10px",color:a.colorSuccessText,minWidth:"90px"}),Le=({token:a})=>({background:a.colorWarningBg,border:`1px solid ${a.colorWarningBorder}`,borderRadius:"10px",color:a.colorWarningText,minWidth:"90px"}),u=1,w=0,D=2,Re=4;function vt(){const[a,n]=ue(),m=Number(a.get("page"))||1,T=Number(a.get("limit"))||10,[d,x]=E.useState({open:!1,type:"Create"}),[A,p]=E.useState([]),N=me(ye),[j,Y]=pe(_e),h=be(j,300),{isFetchingSchedules:$,isLoadingSchedules:v,refetchSchedules:y,scheduleData:r,totalPages:I,totalSchedule:H}=Ie(h,m,T),{deleteSchedule:F,deleteScheduleLoading:q}=$e(),{updateScheduleStatus:Q}=Ae(),[K,V]=Me.useNotification(),{timeZone:L}=ge(Se),G=C(R(L)).format("YYYY-MM-DD HH:mm:ss"),X=(e,o="success")=>{K[o]({description:e,message:"Share Now"})},Z=(e,o)=>{n(t=>(t.set("page",String(e)),t.set("limit",String(o)),t))},J=e=>{const o=r.find(t=>t.id===e);o&&(N(B(o.config,t=>{t.id=o.id})),x({open:!0,type:"Edit"}))},ee=e=>{const o=r.find(t=>t.id===e);o&&(N(B(o.config,t=>{t.settings.name=`Reschedule: ${t.settings.name}`,t.settings.started_at=G,delete t.id})),x({open:!0,type:"Create"}))},te=e=>{Y(e.target.value)},ae=async()=>{await F(A),p([]),y()},se=async e=>{await F([e]),y()},oe=async(e,o)=>{const{data:t,status:c}=await Q({id:e,status:o});X(t,c),y()},ie=[{dataIndex:"title",key:"title",title:i("Title"),width:"20%"},{dataIndex:"created_at",key:"created_at",title:i("Created At")},{dataIndex:"start",key:"start",title:i("Start Scheduled Post")},{dataIndex:"interval",key:"interval",render:(e,{interval:o})=>{var t;return(t=o.settings)!=null&&t.post_interval_value?s(P.Text,{children:`${o.settings.post_interval_value}  ${o.settings.post_interval_type}`}):"-"},title:i("Interval ")},{dataIndex:"nextPost",key:"nextPost",title:i("Next Post ")},{dataIndex:"status",key:"status",render:(e,{interval:o,key:t,status:c})=>{var g;if(!((g=o.settings)!=null&&g.post_interval_value)&&c===u)return s(U,{color:"green",children:i("In Progress")});switch(c){case D:return s(U,{color:"grey",children:i("Completed")});case u:case w:return s(we,{css:c===u?Fe:Le,onChange:_=>oe(t,Number(_)),options:[{disabled:c===u,label:i("Active"),value:u},{disabled:c===w,label:i("Paused"),value:w}],size:"small",value:c===u?"Active":"Paused",variant:"borderless"})}},title:i("Status")},{dataIndex:"action",key:"action",render:(e,{interval:o,key:t,status:c})=>{var g,_;return l(k,{direction:"horizontal",children:[s(W,{description:i("Are you sure you want to delete this schedule?"),okButtonProps:{danger:!0,loading:q},okText:i("Yes, Delete"),onConfirm:()=>se(t),placement:"right",title:i("Delete?"),children:s(S,{danger:!0,icon:s(f,{name:"trash-2"}),type:"text"})}),((g=o.settings)==null?void 0:g.post_interval_value)&&c!==D&&s(S,{icon:s(f,{name:"pencil"}),onClick:()=>J(t),type:"text"}),((_=o.settings)==null?void 0:_.post_interval_value)&&(c===D||c===Re)&&s(S,{icon:s(f,{name:"repeat"}),onClick:()=>ee(t),title:i("Re-schedule"),type:"text"})]})},title:i("Action ")}],re=r&&r.map(e=>({created_at:z(e.created_at,`${b.DATE_FORMAT} ${b.TIME_FORMAT}`),interval:e.config,key:e.id,nextPost:e.next_published_at&&e.status===1&&C(e.next_published_at).diff(R(L))>1?e.human_readable_next_publish:"-",start:e!=null&&e.started_at?z(e.started_at,`${b.DATE_FORMAT} ${b.TIME_FORMAT}`):"-",status:e.status,title:e.name})),ne={onSelect:(e,o)=>{if(e){if(o){p(t=>[...t,e.key]);return}p(t=>t.filter(c=>c!==e.key))}},onSelectAll:(e,o)=>{if(e){p(o.map(t=>t==null?void 0:t.key).filter(t=>t!==void 0));return}p([])}},ce=A.length>0;return E.useEffect(()=>{!r.length&&I&&m>I&&n(e=>(e.set("page",String(I)),e))},[r]),l(M,{children:[V,l(je,{className:"mb-1",justify:"space-between",children:[l(k,{children:[!h&&r.length||h?s(De,{onChange:te,placeholder:i("Search schedule"),prefix:s(f,{name:"search"}),value:j}):void 0,ce?l(M,{children:[s(P.Text,{children:`Selected ${A.length} items`}),s(W,{description:i("Are you sure to delete this logs?"),okButtonProps:{danger:!0},okText:i("Yes, Delete"),onConfirm:ae,placement:"right",title:i("Delete Logs"),children:s(S,{className:"ml-2",danger:!0,icon:s(Ee,{}),type:"text"})})]}):void 0]}),s("div",{children:!h&&r.length||h?l(k,{children:[l(P.Link,{href:"https://bit-social.com/docs/schedule-wordpress-posts-on-social-media/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[i("How to create schedule"),s(f,{name:"move-up-right",style:{transform:"translateY(-2px)"}})]}),s(S,{disabled:$,icon:s(Pe,{spin:$}),onClick:()=>y(),size:"large",children:i("Refresh")}),s(O,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:x})]}):void 0})]}),v&&s(fe,{}),r!=null&&r.length?l(M,{children:[s(Ce,{}),s(ke,{bordered:!0,className:"mt-1",columns:ie,dataSource:re,pagination:{current:m,defaultCurrent:1,onChange:Z,pageSize:T,showSizeChanger:!0,total:H},rowSelection:ne})]}):void 0,!v&&!(r!=null&&r.length)?s(Ne,{description:i("No schedule found!"),children:!h&&s(O,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:x})}):void 0,!v&&!(r!=null&&r.length)?s(ve,{fontSize:"1.6rem",section:"schedule",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};export{vt as default};
