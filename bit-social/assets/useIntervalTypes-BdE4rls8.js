import{B as y,j as o,S as H,T as b,D as i,ag as L,z as O,r as u,F as M,I as R,H as D,J,M as Q,K as P}from"./main-loud-buses-flash.js";import{P as w,p as I}from"./PlatformIcon-g5kbG2HT.js";import{F as $}from"./index-DgGTU6wh.js";import{g as W,a as Y}from"./groupHelper-B64LUuva.js";import{R as U}from"./row-DRTpapjx.js";import{A as X}from"./index-DH3YGDdz.js";import{T as N}from"./index-CPznNvdz.js";import{S as Z}from"./Input-7tgEkJGt.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function ye({iconSize:t=50,textLevel:e=3}){return y($,{align:"center",className:"py-3",gap:20,justify:"center",style:{height:"140px"},vertical:!0,children:[y(H,{children:[o(w,{name:"facebook",size:t}),o(w,{name:"twitter",size:t}),o(w,{name:"pinterest",size:t}),o(w,{name:"googleBusinessProfile",size:t})]}),o(b.Title,{level:e,children:i("Connect your social account first!")})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function B(){const{data:t,isLoading:e,refetch:a}=L({queryFn:async()=>O("active-accounts",void 0,void 0,"GET"),queryKey:["active-accounts"]});return{activeAccounts:(t==null?void 0:t.data)||[],isLoadingActiveAccounts:e,refetchActiveAccounts:a}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const{Text:ee}=b;function _({img:t,name:e}){return o(U,{justify:"space-between",children:y($,{align:"center",gap:6,justify:"center",children:[o(X,{shape:"square",src:t}),o(ee,{ellipsis:!0,title:e,children:e})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const F=(t,e,a,c,r)=>a?c.filter(h=>h.platform===a&&h.details.account_name.toLowerCase().includes(t)):e==="groups"?r:c.filter(h=>h.platform===a),S=t=>[...new Set(t.map(e=>e.platform))],q=(t,e)=>{const a=t?t.map(r=>`account-${r}`):[],c=e?e.map(r=>`group-${r}`):[];return[...a,...c]},te=(t,e,a)=>e.filter(c=>t.includes(c.id)).map(c=>({checkable:!1,key:`account-${a}-${c.id}`,title:o(_,{img:c.details.icon,name:c.details.account_name})})),ae=(t,e,a,c)=>{let r=[];const n=[{children:S(a).map(s=>{var p,f;return r.push(s),{children:F(t,e,s,a,c).map(d=>{const m=`account-${d.id}`;return{disabled:e!=="all"&&e!==s,key:m,style:e!=="all"&&e!==s?{display:" none"}:{},title:"details"in d&&o(_,{img:d.details.icon,name:d.details.account_name})}}),key:s,style:e!==s&&e!=="all"?{display:" none"}:{},title:o(b.Text,{ellipsis:!0,title:(p=I[s])==null?void 0:p.name,children:(f=I[s])==null?void 0:f.name})}}),key:"all",title:i("Select All")}];return e==="all"&&r.push(e,"groups"),e!=="all"&&e!=="groups"&&(r=["all",e]),{accountExpandKeys:r,accountTreeData:n}},se=(t,e,a,c)=>{const r=[],h=[{children:F(t,"groups","",a,c).map(n=>{const s=`group-${n.id}`,p="accounts"in n?W(n):[];return p.length&&r.push(s),{children:te(p,a,s),key:s,style:{overflow:"hidden"},title:"name"in n&&o(b.Text,{ellipsis:!0,title:n.name,children:n.name})}}),key:"groups",style:e==="all"||e==="groups"?{}:{display:" none"},title:i("Groups")}];return{groupExpandKeys:r,groupTreeData:h}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};var ce={name:"16bnd5q",styles:"min-height:100%;overflow:hidden"};function oe({accountType:t,isLoading:e,selectedAccount:a,setSelectedAccount:c}){const[r,h]=u.useState(),[n,s]=u.useState(a),{groups:p}=Y(),{activeAccounts:f}=B(),d=p.map(g=>{const j=g.accounts.map(A=>Number(A.id));return{...g,accountIds:j}}),m=u.useMemo(()=>q(n==null?void 0:n.accountIds,n==null?void 0:n.groupIds),[n]),{groupExpandKeys:v,groupTreeData:x}=u.useMemo(()=>se("",t,f,d),[t,f,p]),C=g=>{const E=Array.isArray(g)?g:g.checked,A=[...new Set(d.filter(l=>E.includes(`group-${l.id}`)).map(l=>Number(l.id)))];s(l=>{const K={...l,groupIds:A};return c(K),K})},k=g=>{h(g)};return u.useEffect(()=>{s(a)},[a]),u.useEffect(()=>{h(v)},[v]),o("div",{css:ce,children:["all","groups"].includes(t)&&y(M,{children:[o(b.Title,{className:"bg-slate-200 p-2 dark:bg-slate-800",level:4,children:i("Groups")}),o(N,{autoExpandParent:!0,blockNode:!0,checkable:!0,checkedKeys:m,className:"pr-3",defaultExpandAll:!0,disabled:e,expandedKeys:r,onCheck:C,onExpand:k,selectable:!1,treeData:x},x.length)]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};var ne={name:"16bnd5q",styles:"min-height:100%;overflow:hidden"},re={name:"1xjypij",styles:"margin:4px 0;width:100%"};function be({isLoading:t,selectedAccount:e,setSelectedAccount:a}){const[c,r]=u.useState("all"),[h,n]=u.useState(),[s,p]=u.useState(e),f=R(Q),{isProClient:d}=D(P),{activeAccounts:m}=B(),v=u.useMemo(()=>q(s==null?void 0:s.accountIds,s==null?void 0:s.groupIds),[s]),x=u.useMemo(()=>S(m).map(l=>({label:I[l].name,value:l})),[m]),{accountExpandKeys:C,accountTreeData:k}=u.useMemo(()=>ae("",c,m,[]),[c,m]),g=[{label:i("All"),value:"all"},{disabled:!d,label:d?"Groups":y(M,{children:[i("Groups")," ",o(J,{color:"#ff8609",size:18})]}),value:"groups"},...x],E=l=>{if(!d&&l==="groups"){f(!0);return}r(l)},j=l=>{const K=Array.isArray(l)?l:l.checked,z=m.filter(T=>K.includes(`account-${T.id}`)).map(T=>T.id),V=[...new Set(z)];p(T=>{const G={...T,accountIds:V};return a(G),G})},A=l=>{n(l)};return u.useEffect(()=>{p(e)},[e]),u.useEffect(()=>{n(C)},[C]),y("div",{css:ne,children:[o(Z,{css:re,defaultValue:c,onChange:E,options:g}),c!=="groups"&&y(M,{children:[o(b.Title,{className:"bg-slate-200 p-2 dark:bg-slate-800",level:4,children:i("Accounts")}),o(N,{autoExpandParent:!0,blockNode:!0,checkable:!0,checkedKeys:v,className:"pr-3",defaultExpandAll:!0,disabled:t,expandedKeys:h,onCheck:j,onExpand:A,selectable:!1,treeData:k},k.length)]}),d&&o(oe,{accountType:c,isLoading:t,selectedAccount:e,setSelectedAccount:a})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function Ae(){const{isProClient:t}=D(P),e=[{label:i("Minute"),value:"minute"},{label:i("Hour"),value:"hour"}],a=[{label:i("Minute"),value:"minute"},{label:i("Hour"),value:"hour"},{label:i("Day"),value:"day"},{label:i("Week"),value:"week"},{label:i("Month"),value:"month"},{label:i("Year"),value:"year"}];return t?a:e}export{ye as A,be as F,B as a,Ae as u};
