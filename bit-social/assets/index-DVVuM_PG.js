import{q as re,v as ie,w as ne,A as ce,r as v,G as le,W as de,R as he,U as ue,z as o,j as s,T as I,y as l,B as T,L as x,S as P,a4 as D,a8 as pe,F as k,a5 as y,I as me,X as ge}from"./main-grumpy-snakes-judge.js";import{u as Se,t as fe,$ as Te,a as xe}from"./DatePicker-Cen4Nr6t.js";import{u as ye}from"./useDebounce-Drz1yYs4.js";import{C as be}from"./CronWarning-Db6mAlym.js";import{u as _e,N as Ce}from"./useUpdateScheduleStatus-Ct9M-H7U.js";import{u as Ae,C as F}from"./CreateScheduleModal-BT-pbGvD.js";import{D as ve,R as Ie,F as Pe}from"./Refresh-BX3OTSTj.js";import{d as E}from"./index-bQ0nfJVu.js";import{s as ke}from"./index-COlXaDoj.js";import{T as $}from"./index-14yEQV7P.js";import{S as we,I as Ee,E as Me}from"./index-D1eUlGgi.js";import{P as L}from"./index-Deb_SY8n.js";import{F as Ne}from"./index-w28iyX2z.js";import"./useSocialTemplates-BXlo0UEi.js";import"./PlatformIcon-DLBB4ipg.js";import"./index-Xk-QyI_X.js";import"./row-vV5a2ekN.js";import"./index-bPEAZM1C.js";import"./useIntervalTypes-D1GKyOFX.js";import"./groupHelper-D2jhe13n.js";import"./index-CfejJzE9.js";import"./EllipsisOutlined-DOoXFrJg.js";import"./Dropdown-DqQ6naC_.js";import"./index-Dxhm2q6q.js";import"./index-CFe8pdUl.js";import"./index-DC9QN4qf.js";import"./collapse-BbEVqHco.js";import"./index-Cpljo4TA.js";import"./index-v40kw7CI.js";import"./index-CY0CGckx.js";import"./EyeOutlined-FfiNH5OE.js";import"./addEventListener-BmgcoT2-.js";import"./LeftOutlined-CRHQX4Bd.js";import"./emotion-react.browser.esm-CcXds07b.js";import"./usePostTypes-CUnNurw5.js";import"./index-Bqthjdoq.js";import"./context-DKbUz7mi.js";import"./index-B-7cFppY.js";import"./index-CznF9zHI.js";import"./move-DbCdynCK.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,i){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,i),i)}};function je(){const t=re(),{isPending:i,isSuccess:p,mutateAsync:S}=ie({mutationFn:async d=>{if(!d.length)throw new Error("Schedule ID is undefined");return ne("schedule/destroy",{scheduleIds:d},void 0,"POST")},onSuccess:()=>{t.invalidateQueries({queryKey:["get-calendar-schedules"]}),t.invalidateQueries({queryKey:["all-schedules"]})}});return{deleteSchedule:d=>S(d),deleteScheduleLoading:i,deleteScheduleSuccess:p}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,i){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,i),i)}};E.extend(Se);E.extend(fe);const De=({token:t})=>({background:t.colorSuccessBg,border:`1px solid ${t.colorSuccessBorder}`,borderRadius:"10px",color:t.colorSuccessText,minWidth:"90px"}),Fe=({token:t})=>({background:t.colorWarningBg,border:`1px solid ${t.colorWarningBorder}`,borderRadius:"10px",color:t.colorWarningText,minWidth:"90px"}),u=1,w=0,R=2;function _t(){const[t,i]=ce(),p=Number(t.get("page"))||1,S=Number(t.get("limit"))||10,[d,b]=v.useState({open:!1,type:"Create"}),[_,m]=v.useState([]),z=le(Te),[M,B]=de(xe),h=ye(M,300),{isFetchingSchedules:N,isLoadingSchedules:C,refetchSchedules:f,scheduleData:n,totalPages:A,totalSchedule:O}=Ae(h,p,S),{deleteSchedule:j,deleteScheduleLoading:W}=je(),{updateScheduleStatus:U}=_e(),[q,H]=ke.useNotification(),{timeZone:Q}=he(ue),Y=(e,r="success")=>{q[r]({description:e,message:"Share Now"})},K=(e,r)=>{i(a=>(a.set("page",String(e)),a.set("limit",String(r)),a))},V=e=>{const r=n.find(a=>a.id===e);r&&(z(ge(r.config,a=>{a.id=r.id})),b({open:!0,type:"Edit"}))},G=e=>{B(e.target.value)},X=async()=>{await j(_),m([]),f()},Z=async e=>{await j([e]),f()},J=async(e,r)=>{const{data:a,status:c}=await U({id:e,status:r});Y(a,c),f()},ee=[{dataIndex:"title",key:"title",title:o("Title"),width:"20%"},{dataIndex:"created_at",key:"created_at",title:o("Created At")},{dataIndex:"start",key:"start",title:o("Start Scheduled Post")},{dataIndex:"interval",key:"interval",render:(e,{interval:r})=>{var a;return(a=r.settings)!=null&&a.post_interval_value?s(I.Text,{children:`${r.settings.post_interval_value}  ${r.settings.post_interval_type}`}):"-"},title:o("Interval ")},{dataIndex:"nextPost",key:"nextPost",title:o("Next Post ")},{dataIndex:"status",key:"status",render:(e,{interval:r,key:a,status:c})=>{var g;if(!((g=r.settings)!=null&&g.post_interval_value)&&c===u)return s($,{color:"green",children:o("In Progress")});switch(c){case R:return s($,{color:"grey",children:o("Completed")});case u:case w:return s(we,{css:c===u?De:Fe,onChange:oe=>J(a,Number(oe)),options:[{disabled:c===u,label:o("Active"),value:u},{disabled:c===w,label:o("Paused"),value:w}],size:"small",value:c===u?"Active":"Paused",variant:"borderless"})}},title:o("Status")},{dataIndex:"action",key:"action",render:(e,{interval:r,key:a,status:c})=>{var g;return l(P,{direction:"horizontal",children:[((g=r.settings)==null?void 0:g.post_interval_value)&&c!==R&&s(T,{icon:s(x,{name:"pencil"}),onClick:()=>V(a),type:"text"}),s(L,{description:o("Are you sure you want to delete this schedule?"),okButtonProps:{danger:!0,loading:W},okText:o("Yes, Delete"),onConfirm:()=>Z(a),placement:"right",title:o("Delete?"),children:s(T,{danger:!0,icon:s(x,{name:"trash-2"}),type:"text"})})]})},title:o("Action ")}],te=n&&n.map(e=>({created_at:D(e.created_at,`${y.DATE_FORMAT} ${y.TIME_FORMAT}`),interval:e.config,key:e.id,nextPost:e.next_published_at&&e.status===1&&E(e.next_published_at).diff(pe(Q))>1?e.human_readable_next_publish:"-",start:e!=null&&e.started_at?D(e.started_at,`${y.DATE_FORMAT} ${y.TIME_FORMAT}`):"-",status:e.status,title:e.name})),ae={onSelect:(e,r)=>{if(e){if(r){m(a=>[...a,e.key]);return}m(a=>a.filter(c=>c!==e.key))}},onSelectAll:(e,r)=>{if(e){m(r.map(a=>a==null?void 0:a.key).filter(a=>a!==void 0));return}m([])}},se=_.length>0;return v.useEffect(()=>{!n.length&&A&&p>A&&i(e=>(e.set("page",String(A)),e))},[n]),l(k,{children:[H,l(Ne,{className:"mb-1",justify:"space-between",children:[l(P,{children:[!h&&n.length||h?s(Ee,{onChange:G,placeholder:o("Search schedule"),prefix:s(x,{name:"search"}),value:M}):void 0,se?l(k,{children:[s(I.Text,{children:`Selected ${_.length} items`}),s(L,{description:o("Are you sure to delete this logs?"),okButtonProps:{danger:!0},okText:o("Yes, Delete"),onConfirm:X,placement:"right",title:o("Delete Logs"),children:s(T,{className:"ml-2",danger:!0,icon:s(ve,{}),type:"text"})})]}):void 0]}),s("div",{children:!h&&n.length||h?l(P,{children:[l(I.Link,{href:"https://bit-social.com/docs/schedule-wordpress-posts-on-social-media/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[o("How to create schedule"),s(x,{name:"move-up-right",style:{transform:"translateY(-2px)"}})]}),s(T,{disabled:N,icon:s(Ie,{spin:N}),onClick:()=>f(),size:"large",children:o("Refresh")}),s(F,{btnTitle:o("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:b})]}):void 0})]}),C&&s(me,{}),n!=null&&n.length?l(k,{children:[s(be,{}),s(Pe,{bordered:!0,className:"mt-1",columns:ee,dataSource:te,pagination:{current:p,defaultCurrent:1,onChange:K,pageSize:S,showSizeChanger:!0,total:O},rowSelection:ae})]}):void 0,!C&&!(n!=null&&n.length)?s(Me,{description:o("No schedule found!"),children:!h&&s(F,{btnTitle:o("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:b})}):void 0,!C&&!(n!=null&&n.length)?s(Ce,{fontSize:"1.6rem",section:"schedule",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,i){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,i),i)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,i){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,i),i)}};export{_t as default};
