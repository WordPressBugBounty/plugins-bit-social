import{y,S as V,j as n,z as i,T as b,a2 as H,w as O,r as u,F as I,G as R,D,H as Q,E as P,L as W}from"./main-spicy-waves-pick.js";import{P as K,p as M}from"./PlatformIcon-DFnVv2U9.js";import{F as $}from"./index-BR9ObBWj.js";import{g as Y,a as J}from"./groupHelper-Q2Z6h_Y0.js";import{A as U}from"./index-1ar1kFWx.js";import{R as X}from"./row-BTzcosep.js";import{T as N}from"./index-qbUP1BDs.js";import{S as Z}from"./index-Bpfui51h.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function ye({iconSize:t=50,textLevel:e=3}){return y($,{align:"center",className:"py-3",gap:20,justify:"center",style:{height:"140px"},vertical:!0,children:[y(V,{children:[n(K,{name:"facebook",size:t}),n(K,{name:"twitter",size:t}),n(K,{name:"pinterest",size:t}),n(K,{name:"googleBusinessProfile",size:t})]}),n(b.Title,{level:e,children:i("Connect your social account first!")})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function _(){const{data:t,isLoading:e,refetch:a}=H({queryFn:async()=>O("active-accounts",void 0,void 0,"GET"),queryKey:["active-accounts"]});return{activeAccounts:(t==null?void 0:t.data)||[],isLoadingActiveAccounts:e,refetchActiveAccounts:a}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const{Text:ee}=b;function B({img:t,name:e}){return n(X,{justify:"space-between",children:y($,{align:"center",gap:6,justify:"center",children:[n(U,{shape:"square",src:t}),n(ee,{ellipsis:!0,title:e,children:e})]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const F=(t,e,a,c,r)=>a?c.filter(h=>h.platform===a&&h.details.account_name.toLowerCase().includes(t)):e==="groups"?r:c.filter(h=>h.platform===a),S=t=>[...new Set(t.map(e=>e.platform))],q=(t,e)=>{const a=t?t.map(r=>`account-${r}`):[],c=e?e.map(r=>`group-${r}`):[];return[...a,...c]},te=(t,e,a)=>e.filter(c=>t.includes(c.id)).map(c=>({checkable:!1,key:`account-${a}-${c.id}`,title:n(B,{img:c.details.icon,name:c.details.account_name})})),ae=(t,e,a,c)=>{let r=[];const o=[{children:S(a).map(s=>{var p,f;return r.push(s),{children:F(t,e,s,a,c).map(d=>{const m=`account-${d.id}`;return{disabled:e!=="all"&&e!==s,key:m,style:e!=="all"&&e!==s?{display:" none"}:{},title:"details"in d&&n(B,{img:d.details.icon,name:d.details.account_name})}}),key:s,style:e!==s&&e!=="all"?{display:" none"}:{},title:n(b.Text,{ellipsis:!0,title:(p=M[s])==null?void 0:p.name,children:(f=M[s])==null?void 0:f.name})}}),key:"all",title:i("Select All")}];return e==="all"&&r.push(e,"groups"),e!=="all"&&e!=="groups"&&(r=["all",e]),{accountExpandKeys:r,accountTreeData:o}},se=(t,e,a,c)=>{const r=[],h=[{children:F(t,"groups","",a,c).map(o=>{const s=`group-${o.id}`,p="accounts"in o?Y(o):[];return p.length&&r.push(s),{children:te(p,a,s),key:s,style:{overflow:"hidden"},title:"name"in o&&n(b.Text,{ellipsis:!0,title:o.name,children:o.name})}}),key:"groups",style:e==="all"||e==="groups"?{}:{display:" none"},title:i("Groups")}];return{groupExpandKeys:r,groupTreeData:h}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};var ce={name:"16bnd5q",styles:"min-height:100%;overflow:hidden"};function ne({accountType:t,isLoading:e,selectedAccount:a,setSelectedAccount:c}){const[r,h]=u.useState(),[o,s]=u.useState(a),{groups:p}=J(),{activeAccounts:f}=_(),d=p.map(g=>{const j=g.accounts.map(A=>Number(A.id));return{...g,accountIds:j}}),m=u.useMemo(()=>q(o==null?void 0:o.accountIds,o==null?void 0:o.groupIds),[o]),{groupExpandKeys:v,groupTreeData:x}=u.useMemo(()=>se("",t,f,d),[t,f,p]),C=g=>{const E=Array.isArray(g)?g:g.checked,A=[...new Set(d.filter(l=>E.includes(`group-${l.id}`)).map(l=>Number(l.id)))];s(l=>{const w={...l,groupIds:A};return c(w),w})},k=g=>{h(g)};return u.useEffect(()=>{s(a)},[a]),u.useEffect(()=>{h(v)},[v]),n("div",{css:ce,children:["all","groups"].includes(t)&&y(I,{children:[n(b.Title,{className:"bg-slate-200 p-2 dark:bg-slate-800",level:4,children:i("Groups")}),n(N,{autoExpandParent:!0,blockNode:!0,checkable:!0,checkedKeys:m,className:"pr-3",defaultExpandAll:!0,disabled:e,expandedKeys:r,onCheck:C,onExpand:k,selectable:!1,treeData:x},x.length)]})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};var oe={name:"16bnd5q",styles:"min-height:100%;overflow:hidden"},re={name:"1xjypij",styles:"margin:4px 0;width:100%"};function be({isLoading:t,selectedAccount:e,setSelectedAccount:a}){const[c,r]=u.useState("all"),[h,o]=u.useState(),[s,p]=u.useState(e),f=R(Q),{isProClient:d}=D(P),{activeAccounts:m}=_(),v=u.useMemo(()=>q(s==null?void 0:s.accountIds,s==null?void 0:s.groupIds),[s]),x=u.useMemo(()=>S(m).map(l=>({label:M[l].name,value:l})),[m]),{accountExpandKeys:C,accountTreeData:k}=u.useMemo(()=>ae("",c,m,[]),[c,m]),g=[{label:i("All"),value:"all"},{disabled:!d,label:d?"Groups":y(I,{children:[i("Groups")," ",n(W,{color:"#ff8609",name:"crown",size:18})]}),value:"groups"},...x],E=l=>{if(!d&&l==="groups"){f(!0);return}r(l)},j=l=>{const w=Array.isArray(l)?l:l.checked,z=m.filter(T=>w.includes(`account-${T.id}`)).map(T=>T.id),L=[...new Set(z)];p(T=>{const G={...T,accountIds:L};return a(G),G})},A=l=>{o(l)};return u.useEffect(()=>{p(e)},[e]),u.useEffect(()=>{o(C)},[C]),y("div",{css:oe,children:[n(Z,{css:re,defaultValue:c,onChange:E,options:g}),c!=="groups"&&y(I,{children:[n(b.Title,{className:"bg-slate-200 p-2 dark:bg-slate-800",level:4,children:i("Accounts")}),n(N,{autoExpandParent:!0,blockNode:!0,checkable:!0,checkedKeys:v,className:"pr-3",defaultExpandAll:!0,disabled:t,expandedKeys:h,onCheck:j,onExpand:A,selectable:!1,treeData:k},k.length)]}),d&&n(ne,{accountType:c,isLoading:t,selectedAccount:e,setSelectedAccount:a})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function Ae(){const{isProClient:t}=D(P),e=[{label:i("Minute"),value:"minute"},{label:i("Hour"),value:"hour"}],a=[{label:i("Minute"),value:"minute"},{label:i("Hour"),value:"hour"},{label:i("Day"),value:"day"},{label:i("Week"),value:"week"},{label:i("Month"),value:"month"},{label:i("Year"),value:"year"}];return t?a:e}export{ye as A,be as F,_ as a,Ae as u};
