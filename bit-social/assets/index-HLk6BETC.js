import{r as re,c as ie,h as ne,g as ce,e as le,l as D,n as de,a as c,j as s,F as v,_ as f,L as x,m as T,p as he}from"./main-some-women-speak.js";import{u as ue,t as ge,$ as pe,a as me}from"./DatePicker-CqphXXkq.js";import{u as Se}from"./useDebounce-DWVHBZjD.js";import{C as fe}from"./CronWarning-BDlyjNsw.js";import{u as xe,N as Te}from"./useUpdateScheduleStatus-C6HBCA31.js";import{u as ye,C as $}from"./CreateScheduleModal-2LGbUl8z.js";import{R as be,D as _e}from"./Refresh-vI4MAna2.js";import{r as I,s as Ce,z as w,F as Ae,S as P,T as k,B as y,I as ve,P as F,n as Ie,x as Pe,E as ke,q as L,v as Ee}from"./antd-Dkhz2BjJ.js";import{u as we}from"./router-BDBqwsZt.js";import{a as Me,b as Ne}from"./react-query-B4O-PG_a.js";import"./css-in-js-D9KZUreV.js";import"./_socialTemplates-Dn3A61Ix.js";import"./PlatformIcon-DUhbVgxv.js";import"./useIntervalTypes-Dy4Aw593.js";import"./groupHelper-LXyWAMdx.js";import"./index-CAwduSRX.js";import"./useSocialTemplates-OyCNOoJb.js";import"./usePostTypes-Cc3A4lmY.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,r){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,r),r)}};function je(){const t=Me(),{isPending:r,isSuccess:u,mutateAsync:m}=Ne({mutationFn:async l=>{if(!l.length)throw new Error("Schedule ID is undefined");return re("schedule/destroy",{scheduleIds:l},void 0,"POST")},onSuccess:()=>{t.invalidateQueries({queryKey:["get-calendar-schedules"]}),t.invalidateQueries({queryKey:["all-schedules"]})}});return{deleteSchedule:l=>m(l),deleteScheduleLoading:r,deleteScheduleSuccess:u}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,r){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,r),r)}};w.extend(ue);w.extend(ge);const De=({token:t})=>({background:t.colorSuccessBg,border:`1px solid ${t.colorSuccessBorder}`,borderRadius:"10px",color:t.colorSuccessText,minWidth:"90px"}),$e=({token:t})=>({background:t.colorWarningBg,border:`1px solid ${t.colorWarningBorder}`,borderRadius:"10px",color:t.colorWarningText,minWidth:"90px"}),h=1,E=0,z=2;function et(){const[t,r]=we(),u=Number(t.get("page"))||1,m=Number(t.get("limit"))||10,[l,b]=I.useState({open:!1,type:"Create"}),[_,g]=I.useState([]),R=ie(pe),[M,B]=ne(me),d=Se(M,300),{isFetchingSchedules:N,isLoadingSchedules:C,refetchSchedules:S,scheduleData:i,totalPages:A,totalSchedule:O}=ye(d,u,m),{deleteSchedule:j,deleteScheduleLoading:W}=je(),{updateScheduleStatus:q}=xe(),[U,H]=Ce.useNotification(),{timeZone:Q}=ce(le),Y=(e,o="success")=>{U[o]({description:e,message:"Share Now"})},K=(e,o)=>{r(a=>(a.set("page",String(e)),a.set("limit",String(o)),a))},V=e=>{const o=i.find(a=>a.id===e);o&&(R(he(o.config,a=>{a.id=o.id})),b({open:!0,type:"Edit"}))},Z=e=>{B(e.target.value)},G=async()=>{await j(_),g([]),S()},J=async e=>{await j([e]),S()},X=async(e,o)=>{const{data:a,status:n}=await q({id:e,status:o});Y(a,n),S()},ee=[{dataIndex:"title",key:"title",title:"Title",width:"20%"},{dataIndex:"created_at",key:"created_at",title:"Created At"},{dataIndex:"start",key:"start",title:"Start Scheduled Post"},{dataIndex:"interval",key:"interval",render:(e,{interval:o})=>{var a;return(a=o.settings)!=null&&a.post_interval_value?s(k.Text,{children:`${o.settings.post_interval_value}  ${o.settings.post_interval_type}`}):"-"},title:"Interval "},{dataIndex:"nextPost",key:"nextPost",title:"Next Post "},{dataIndex:"status",key:"status",render:(e,{interval:o,key:a,status:n})=>{var p;if(!((p=o.settings)!=null&&p.post_interval_value)&&n===h)return s(L,{color:"green",children:f("In Progress")});switch(n){case z:return s(L,{color:"grey",children:f("Completed")});case h:case E:return s(Ee,{css:n===h?De:$e,onChange:oe=>X(a,Number(oe)),options:[{disabled:n===h,label:"Active",value:h},{disabled:n===E,label:"Paused",value:E}],size:"small",value:n===h?"Active":"Paused",variant:"borderless"})}},title:"Status"},{dataIndex:"action",key:"action",render:(e,{interval:o,key:a,status:n})=>{var p;return c(P,{direction:"horizontal",children:[((p=o.settings)==null?void 0:p.post_interval_value)&&n!==z&&s(y,{icon:s(x,{name:"pencil"}),onClick:()=>V(a),type:"text"}),s(F,{description:"Are you sure you want to delete this schedule?",okButtonProps:{danger:!0,loading:W},okText:"Yes, Delete",onConfirm:()=>J(a),placement:"right",title:"Delete?",children:s(y,{danger:!0,icon:s(x,{name:"trash-2"}),type:"text"})})]})},title:"Action "}],te=i&&i.map(e=>({created_at:D(e.created_at,`${T.DATE_FORMAT} ${T.TIME_FORMAT}`),interval:e.config,key:e.id,nextPost:e.next_published_at&&e.status===1&&w(e.next_published_at).diff(de(Q))>1?e.human_readable_next_publish:"-",start:e!=null&&e.started_at?D(e.started_at,`${T.DATE_FORMAT} ${T.TIME_FORMAT}`):"-",status:e.status,title:e.name})),ae={onSelect:(e,o)=>{if(e){if(o){g(a=>[...a,e.key]);return}g(a=>a.filter(n=>n!==e.key))}},onSelectAll:(e,o)=>{if(e){g(o.map(a=>a==null?void 0:a.key).filter(a=>a!==void 0));return}g([])}},se=_.length>0;return I.useEffect(()=>{!i.length&&A&&u>A&&r(e=>(e.set("page",String(A)),e))},[i]),c(v,{children:[H,c(Ae,{className:"mb-1",justify:"space-between",children:[c(P,{children:[!d&&i.length||d?s(ve,{onChange:Z,placeholder:"Search schedule",prefix:s(x,{name:"search"}),value:M}):void 0,se?c(v,{children:[s(k.Text,{children:`Selected ${_.length} items`}),s(F,{description:"Are you sure to delete this logs?",okButtonProps:{danger:!0},okText:"Yes, Delete",onConfirm:G,placement:"right",title:"Delete Logs",children:s(y,{className:"ml-2",danger:!0,icon:s(_e,{}),type:"text"})})]}):void 0]}),s("div",{children:!d&&i.length||d?c(P,{children:[c(k.Link,{href:"https://bit-social.com/docs/schedule-wordpress-posts-on-social-media/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[f("How to create schedule"),s(x,{name:"move-up-right",style:{transform:"translateY(-2px)"}})]}),s(y,{disabled:N,icon:s(be,{spin:N}),onClick:()=>S(),size:"large",children:f("Refresh")}),s($,{btnTitle:"Create Schedule",isScheduleModalOpen:l,setIsScheduleModalOpen:b})]}):void 0})]}),C&&s(Ie,{}),i!=null&&i.length?c(v,{children:[s(fe,{}),s(Pe,{bordered:!0,className:"mt-1",columns:ee,dataSource:te,pagination:{current:u,defaultCurrent:1,onChange:K,pageSize:m,showSizeChanger:!0,total:O},rowSelection:ae})]}):void 0,!C&&!(i!=null&&i.length)?s(ke,{description:"No schedule found!",children:!d&&s($,{btnTitle:"Create Schedule",isScheduleModalOpen:l,setIsScheduleModalOpen:b})}):void 0,!C&&!(i!=null&&i.length)?s(Te,{fontSize:"1.6rem",section:"schedule",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,r){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,r),r)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,r){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,r),r)}};export{et as default};
