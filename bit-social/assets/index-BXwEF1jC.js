import{x as le,y as de,z as ue,G as he,a4 as $,r as R,I as me,a2 as pe,a3 as ge,as as F,D as i,j as o,T as I,B as l,E as S,S as M,aj as z,F as P,N as Se,L as fe,at as Te,am as xe,an as _,V as ye,O as _e,a5 as O}from"./main-young-lights-chew.js";import{$ as be,a as Ce,b as Ae,u as ve,t as Ie}from"./DatePicker-go7uULjW.js";import{u as Me}from"./useDebounce-EPTnkYqv.js";import{C as Pe}from"./CronWarning-Di50NF8Z.js";import{u as Ee,N as ke}from"./useUpdateScheduleStatus-B3M-RBAv.js";import{u as De,C as B}from"./CreateScheduleModal-BuJkVUiw.js";import{R as we,D as Le}from"./Refresh-Byn1-B6q.js";import{d as b}from"./index-DEX0XGPc.js";import{s as Ne}from"./index-DlblzFWm.js";import{T as U}from"./index-UrBM9rbx.js";import{S as je,E as $e}from"./index-BzR7PP63.js";import{P as Y}from"./index-BTVjOkmX.js";import{F as Re}from"./index-C2qxlNyk.js";import{I as Fe}from"./index-DhRqjnRn.js";import{F as ze}from"./Table-DgMIH_q1.js";import"./useSocialTemplates-JDm_42QP.js";import"./PlatformIcon-oNYlbIhm.js";import"./index-DoInJtNp.js";import"./row-iM0_cNJs.js";import"./mediaQueryUtil-BSyvLspT.js";import"./index-BsYfOlMh.js";import"./useIntervalTypes-Bx6YkoIn.js";import"./platforms-D2zu1ywB.js";import"./groupHelper-BM9s2S0b.js";import"./index-BeHc61sQ.js";import"./EllipsisOutlined-DEykQ9-v.js";import"./Dropdown-CfK_P-47.js";import"./index-lni2znia.js";import"./index-CXBnDRm-.js";import"./index-Cz8QKJTu.js";import"./collapse-BbEVqHco.js";import"./index-D9jx9097.js";import"./AiPromptConfigModal-5Lp1WVG9.js";import"./index-C_2Mx4AL.js";import"./index-D3CBBcBq.js";import"./EyeOutlined-C7fxy07Z.js";import"./addEventListener-UsEDJ7TW.js";import"./LeftOutlined-DSs3weL_.js";import"./ProGoogleBusinessProfileSettings-DUhrf8yw.js";import"./useMemoDebounce-igu0p9jJ.js";import"./useUpdateSocialTemplates-Dq5r-e9e.js";import"./PreviewDummy-kQZYE60_.js";import"./TemplateDocLink-BIcUO9GP.js";import"./index-DJdB1Prm.js";import"./context-DMw-TGz6.js";import"./index-BZLGCgI8.js";import"./AntIconWrapper-BFTODLMy.js";import"./emotion-react.browser.esm-CX5f4VSI.js";import"./usePostTypes-DkTkwI9c.js";import"./move-68TfqWnp.js";import"./Input-BergVNZ6.js";import"./index-Bagc_Qaj.js";import"./index-CMzasQid.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};function Oe(){const a=le(),{isPending:n,isSuccess:m,mutateAsync:f}=de({mutationFn:async d=>{if(!d.length)throw new Error("Schedule ID is undefined");return ue("schedule/destroy",{scheduleIds:d},void 0,"POST")},onSuccess:()=>{a.invalidateQueries({queryKey:["get-calendar-schedules"]}),a.invalidateQueries({queryKey:["all-schedules"]})}});return{deleteSchedule:d=>f(d),deleteScheduleLoading:n,deleteScheduleSuccess:m}}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};b.extend(ve);b.extend(Ie);const Be=({token:a})=>({background:a.colorSuccessBg,border:`1px solid ${a.colorSuccessBorder}`,borderRadius:"10px",color:a.colorSuccessText,minWidth:"90px"}),Ue=({token:a})=>({background:a.colorWarningBg,border:`1px solid ${a.colorWarningBorder}`,borderRadius:"10px",color:a.colorWarningText,minWidth:"90px"}),h=1,E=0,k=2,Ye=4;function Yt(){const[a,n]=he(),m=Number(a.get("page"))||1,f=Number(a.get("limit"))||10,[d,T]=$(be),[C,p]=R.useState([]),D=me(Ce),[w,H]=$(Ae),u=Me(w,300),{isFetchingSchedules:L,isLoadingSchedules:A,refetchSchedules:x,scheduleData:r,totalPages:v,totalSchedule:W}=De(u,m,f),{deleteSchedule:N,deleteScheduleLoading:q}=Oe(),{updateScheduleStatus:Q}=Ee(),[V,K]=Ne.useNotification(),{timeZone:j}=pe(ge),G=b(F(j)).format("YYYY-MM-DD HH:mm:ss"),Z=(e,s="success")=>{V[s]({description:e,message:"Share Now"})},J=(e,s)=>{n(t=>(t.set("page",String(e)),t.set("limit",String(s)),t))},X=e=>{const s=r.find(t=>t.id===e);s&&(D(O(s.config,t=>{t.id=s.id})),T({open:!0,type:"edit"}))},ee=e=>{const s=r.find(t=>t.id===e);s&&(D(O(s.config,t=>{t.settings.name=`Reschedule: ${t.settings.name}`,t.settings.started_at=G,delete t.id})),T({open:!0,type:"reSchedule"}))},te=e=>{H(e.target.value)},ae=async()=>{await N(C),p([]),x()},oe=async e=>{await N([e]),x()},se=async(e,s)=>{const{data:t,status:c}=await Q({id:e,status:s});Z(t,c),x()},ie=[{dataIndex:"title",key:"title",title:i("Title"),width:"20%"},{dataIndex:"created_at",key:"created_at",title:i("Created At")},{dataIndex:"start",key:"start",title:i("Start Scheduled Post")},{dataIndex:"interval",key:"interval",render:(e,{interval:s})=>{var t;return(t=s.settings)!=null&&t.post_interval_value?o(I.Text,{children:`${s.settings.post_interval_value}  ${s.settings.post_interval_type}`}):"-"},title:i("Interval ")},{dataIndex:"nextPost",key:"nextPost",title:i("Next Post ")},{dataIndex:"status",key:"status",render:(e,{interval:s,key:t,status:c})=>{var g;if(!((g=s.settings)!=null&&g.post_interval_value)&&c===h)return o(U,{color:"green",children:i("In Progress")});switch(c){case k:return o(U,{color:"grey",children:i("Completed")});case h:case E:return o(je,{css:c===h?Be:Ue,onChange:y=>se(t,Number(y)),options:[{disabled:c===h,label:i("Active"),value:h},{disabled:c===E,label:i("Paused"),value:E}],size:"small",value:c===h?"Active":"Paused",variant:"borderless"})}},title:i("Status")},{dataIndex:"action",key:"action",render:(e,{interval:s,key:t,status:c})=>{var g,y;return l(M,{direction:"horizontal",children:[o(Y,{description:i("Are you sure you want to delete this schedule?"),okButtonProps:{danger:!0,loading:q},okText:i("Yes, Delete"),onConfirm:()=>oe(t),placement:"right",title:i("Delete?"),children:o(S,{danger:!0,icon:o(fe,{}),type:"text"})}),((g=s.settings)==null?void 0:g.post_interval_value)&&c!==k&&o(S,{icon:o(Te,{}),onClick:()=>X(t),type:"text"}),((y=s.settings)==null?void 0:y.post_interval_value)&&(c===k||c===Ye)&&o(S,{icon:o(xe,{}),onClick:()=>ee(t),title:i("Re-schedule"),type:"text"})]})},title:i("Action ")}],re=r&&r.map(e=>({created_at:z(e.created_at,`${_.DATE_FORMAT} ${_.TIME_FORMAT}`),interval:e.config,key:e.id,nextPost:e.next_published_at&&e.status===1&&b(e.next_published_at).diff(F(j))>1?e.human_readable_next_publish:"-",start:e!=null&&e.started_at?z(e.started_at,`${_.DATE_FORMAT} ${_.TIME_FORMAT}`):"-",status:e.status,title:e.name})),ne={onSelect:(e,s)=>{if(e){if(s){p(t=>[...t,e.key]);return}p(t=>t.filter(c=>c!==e.key))}},onSelectAll:(e,s)=>{if(e){p(s.map(t=>t==null?void 0:t.key).filter(t=>t!==void 0));return}p([])}},ce=C.length>0;return R.useEffect(()=>{!r.length&&v&&m>v&&n(e=>(e.set("page",String(v)),e))},[r]),l(P,{children:[K,l(Re,{className:"mb-1",justify:"space-between",children:[l(M,{children:[!u&&r.length||u?o(Fe,{onChange:te,placeholder:i("Search schedule"),prefix:o(ye,{}),value:w}):void 0,ce?l(P,{children:[o(I.Text,{children:`Selected ${C.length} items`}),o(Y,{description:i("Are you sure to delete this logs?"),okButtonProps:{danger:!0},okText:i("Yes, Delete"),onConfirm:ae,placement:"right",title:i("Delete Logs"),children:o(S,{className:"ml-2",danger:!0,icon:o(Le,{}),type:"text"})})]}):void 0]}),o("div",{children:!u&&r.length||u?l(M,{children:[l(I.Link,{href:"https://bit-social.com/docs/schedule-wordpress-posts-on-social-media/",rel:"noopener noreferrer",strong:!0,style:{fontSize:"18px"},target:"_blank",children:[i("How to create schedule"),o(Se,{style:{transform:"translateY(-2px)"}})]}),o(S,{disabled:L,icon:o(we,{spin:L}),onClick:()=>x(),size:"large",children:i("Refresh")}),o(B,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:T})]}):void 0})]}),A&&o(_e,{}),r!=null&&r.length?l(P,{children:[o(Pe,{}),o(ze,{bordered:!0,className:"mt-1",columns:ie,dataSource:re,pagination:{current:m,defaultCurrent:1,onChange:J,pageSize:f,showSizeChanger:!0,total:W},rowSelection:ne})]}):void 0,!A&&!(r!=null&&r.length)?o($e,{description:i("No schedule found!"),children:!u&&o(B,{btnTitle:i("Create Schedule"),isScheduleModalOpen:d,setIsScheduleModalOpen:T})}):void 0,!A&&!(r!=null&&r.length)?o(ke,{fontSize:"1.6rem",section:"schedule",style:{marginTop:"30px",textAlign:"justify"}}):void 0]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,n){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,n),n)}};export{Yt as default};
